{"version":3,"file":"contour.min.js","sources":["?","../src/scripts/header.js","../src/scripts/core/contour-utils.js","../src/scripts/core/contour.js","../src/scripts/core/axis/y-axis.js","../src/scripts/core/cartesian.js","../src/scripts/core/exportable.js","../src/scripts/version.js","../src/scripts/core/axis/axis-scale-factory.js","../src/scripts/core/axis/linear-scale-axis.js","../src/scripts/core/axis/log-y-axis.js","../src/scripts/core/axis/ordinal-scale-axis.js","../src/scripts/core/axis/smart-y-axis.js","../src/scripts/core/axis/time-scale-axis.js","../src/scripts/core/horizontal-frame.js","../src/scripts/core/visualization-container.js","../src/scripts/visualizations/area.js","../src/scripts/visualizations/bar.js","../src/scripts/visualizations/column.js","../src/scripts/visualizations/cool-narwhal.js","../src/scripts/visualizations/legend.js","../src/scripts/visualizations/line.js","../src/scripts/visualizations/null.js","../src/scripts/visualizations/pie.js","../src/scripts/visualizations/scatter.js","../src/scripts/visualizations/stack-tooltip.js","../src/scripts/visualizations/tooltip.js","../src/scripts/visualizations/trend-line.js"],"names":["exports","global","undefined","root","this","module","require","d3","_","Error","merge","multiplier","x","dig","nw","decDigits","Math","pow","maxMultiplier","a","b","max","addFloat","factor","aa","bb","subFloat","mulFloat","divFloat","toFixed","digits","noop","generalHelpers","getValue","src","deafult","ctx","args","Array","prototype","slice","call","arguments","apply","seriesNameToClass","name","dataFilters","cleanNullValues","series","map","s","extend","data","reduce","acum","datum","y","push","minMaxFilter","desiredLen","length","toReturn","index","increment","floor","maxPt","minPt","hasValidPt","maxIndex","min","intermediateIndex","intermediatePt","logging","warn","msg","console","log","numberHelpers","firstAndLast","ar","roundToNearest","number","multiple","ceil","roundTo","value","trunc","abs","LN10","parts","toString","split","log10","clamp","val","l","h","clampLeft","low","clampRight","high","degToRad","deg","PI","radToDeg","rad","rotatePoint","point","cos","sin","translatePoint","delta","linearRegression","dataSrc","lr","n","sum_x","sum_y","sum_xy","sum_xx","sum_yy","i","slope","intercept","r2","sqrt","niceRound","axisHelpers","addAxis","axisCtor","axes","roundToNextTick","num","mag","step","sign","exp","toExponential","replace","raw","niceMinMax","ticks","startAtZero","swap","origMax","excelRoundUp","up","roundFn","v","tickValues","defaultRounding","negativeMinAmount","intermediateMax","iMin","roundToDigits","inter","intermediateMin","interval","finalMin","finalMax","ticksValues","prevTick","j","newTick","extractScaleDomain","domain","zeroAnchor","dataMin","dataMax","niceTicks","calcXLabelsWidths","padding","compact","String","d","textBounds","width","doXLabelsFit","labelFormatter","options","tickWidths","availableWidthForLabels","chart","plotWidth","axisLabelsWidth","sum","getTicksThatFit","reduceTicksByMod","iter","filterMod","finalTicks","filter","stringHelpers","text","css","body","document","getElementsByTagName","wrapper","createElement","dummy","className","style","position","height","visibility","lineHeight","whiteSpace","innerHTML","appendChild","res","clientWidth","clientHeight","removeChild","dateHelpers","dateDiff","d1","d2","diff","getTime","arrayHelpers","array1","array2","concat","sort","isCorrectDataFormat","dataArray","isArray","all","p","hasOwnProperty","isCorrectSeriesFormat","isArrayOfObjects","isObject","hasDataArrayPerSeries","hasSeriesNamePerSeries","datumInCorrectFormat","normalizeSeries","categories","sortFn","normal","set","hasX","categoryAt","hasCategories","correctDataFormat","correctSeriesFormat","stackLayout","stack","layout","values","outFn","y0s","y0","out","uniq","array","cache","result","len","el","key","acc","cur","maxTickValues","tickInteval","isSupportedDataFormat","domHelpers","selectDom","selector","select","getStyle","elem","styles","offsetParent","ownerDocument","defaultView","getComputedStyle","getCentroid","element","getOffsetParent","t","tagName","parentNode","parentBox","getBoundingClientRect","bbox","left","top","debuggingHelpers","warning","Contour","init","lastData","defaults","animations","enable","duration","defaultWidth","defaultAspect","margin","right","bottom","internalPadding","rotatedFrame","plotHeight","plotTop","plotLeft","xAxis","yAxis","tooltip","ctorName","renderer","sortSeries","each","shouldSort","isDate","sortFunc","vis","opt","ownData","VisualizationContainer","_visualizations","expose","functionalityConstructor","ctor","functionality","Object","create","omit","_exposed","_extraOptions","calculateWidth","outerWidth","parseInt","paddingLeft","paddingRight","calculateHeight","outerHeight","paddingTop","paddingBottom","containerHeight","calcWidth","ratio","aspect","round","calcMetrics","adjustPadding","adjustTitlePadding","composeOptions","allDefaults","mergeExtraOptions","mergeDefaults","baseRender","plotArea","render","renderVisualizations","resize","container","update","chartOpt","attr","svg","node","append","createVisualizationLayer","id","type","visualization","layer","parent","checkDependencies","listOfDependencies","_this","missing","dep","indexOf","join","ensureDefaults","isString","setData","invoke","dataNormalizer","define","amd","setRange","scale","rangeSize","range","YAxis","axis","dMin","dMax","numTicks","format","labels","formatter","_scale","tickFormat","tickSize","innerTickSize","outerTickSize","tickPadding","linear","setDomain","_niceTheScale","gridlines","maxTicks","title","titlePadding","innerRangePadding","outerRangePadding","orient","linearDomain","smartAxis","verticalAlign","cartesian","maxTickSize","readOnlyProps","extraPadding","xDomain","yDomain","_getYScaledDomain","absMin","extent","xOptions","yOptions","_getAdjustedBottomPadding","_getAdjustedTopPadding","_getAdjustedLeftPadding","_getAdjustedRightPadding","xLabels","xAxisText","xLabelBounds","regularXBounds","em","ang","rotation","xLabelHeightUsed","yDomainScaled","tmpScale","yLabels","yAxisText","yLabelBounds","titleBounds","computeXScale","xScale","xScaleGenerator","rangeBand","xScaleFactory","computeYScale","yScaleDomain","yScale","yScaleGenerator","yScaleFactory","setYDomain","redrawYAxis","renderGridlines","_animationDuration","computeScales","_xAxis","_yAxis","renderXAxis","_xAxisGroup","selectAll","enter","transition","postProcessAxis","renderYAxis","_yAxisGroup","_renderYAxisElement","alignmentOffset","middle","renderAxisLabels","bounds","adjustFactor","getYTicks","smart","pop","getXTicks","gr","option","horizontal","vertical","w","lines","exit","remove","offset","renderBackground","background","g","adjustDomain","bind","extents","getExtents","_adjustXDomain","_adjustYDomain","getXDomain","dataVis","flatten","isCategoricalData","dataSrcCategories","pluck","sameCats","intersection","yMin","yMax","field","addToQueue","fn","working","queue","startWork","finishWork","shift","checkBrowser","checkEncodesBase64","browser","encodesBase64","btoa","setupBase64Shim","checkADownloads","aDownloads","download","checkSavesMsBlobs","savesMsBlobs","navigator","msSaveOrOpenBlob","checkCreatesObjectUrls","domUrl","URL","webkitURL","createsObjectUrls","createObjectURL","checkExportsSvg","svgExportChecked","iframe","exportsSvg","setupCanvgShim","doc","contentWindow","onload","querySelector","img","canvas","context","getContext","getAttribute","sourceImg","Image","drawImage","toDataURL","e","xml","XMLSerializer","serializeToString","encodeURIComponent","open","write","close","InvalidCharacterError","message","chars","input","block","charCode","str","idx","output","charAt","charCodeAt","done","scripts","remaining","script","head","checked","defaultParams","fileName","target","backgroundColor","exportable","getSvgDataUrl","dataUrlCreated","encodeBase64DataUrl","svgXml","dataUrlToBlob","dataUrl","byteString","atob","unescape","mimeString","byteArray","Uint8Array","Blob","makeSvgUrl","svgDataUrl","makeImageUrl","imageRendered","imageDataUrl","imageBlob","objectUrl","revokeObjectURL","renderImageNative","svgImg","fillStyle","fillRect","onerror","renderImageCanvg","canvg","ignoreMouse","ignoreAnimation","offsetX","offsetY","scaleWidth","scaleHeight","renderCallback","createSvgClone","svgNode","svgCloned","applyStyles","sourceNode","targetNode","sourceStyle","targetStyle","prop","cssIgnoreDiff","isFinite","cloneNodes","newNode","cloneNode","childNodes","childNode","createIsolatedNode","nodeLoaded","iframeWindow","iframeDocument","nodeClone","destroyIframe","applyDivStylesToSvg","cssSharedSvg","nodeName","rx","borderTopLeftRadius","ry","fill","stroke","borderLeftColor","stroke-width","borderLeftWidth","color","cloneLegendDiv","containerDiv","empty","containerDivNode","containerSvg","offsetLeft","clientLeft","offsetTop","clientTop","rect","entriesDivs","entryDivNode","getEntryDivSubNode","entryDiv","entryDivKeyNode","swatch","offsetWidth","offsetHeight","entryDivSeriesNode","textContent","destroyIsolatedNode","getProportionedBounds","original","specified","exportImage","exporter","performExport","svgNodeClone","destroySvgClone","setAttribute","boundsClone","win","url","blob","revokeUrl","exporters","href","click","location","setTimeout","place","cssText","parentRule","font","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","direction","letterSpacing","textDecoration","unicodeBidi","wordSpacing","clip","cursor","display","overflow","opacity","version","helpers","isTimeData","TimeScale","OrdinalScale","LinearScale","axisType","LogYAxis","SmartYAxis","_domain","_getAxisDomain","nice","_setRange","formatLabel","getDate","labelsFit","optMin","optMax","__super","ticksHint","isCategorized","ordinal","optFormat","axisGroup","pos","lineCenter","anchor","text-anchor","ref","_range","band","numCats","threshold","rangeType","rangePoints","_extractYTickValues","adjustedDomain","perTreshold","rawMax","nextTick","time","getOptimalTickFormat","axisDomain","spanDays","daysThreshold","_getAxisRange","rangeRound","size","frame","categoryLabels","xLabel","yLabel","lineHeightAdjustment","titleOneEm","VisInstanceContainer","_extent","maxs","mins","_stackedExtent","dataSets","ext","_xExtent","partialRight","_yExtent","setOptions","normalizeData","_updateDomain","isSupportedFormat","xExtent","yExtent","stacked","renderSeries","area","preprocess","classFn","startArea","renderTooltipTrackers","trackerSize","markers","dots","y1","areaBase","smooth","interpolate","barRender","bar","chartOffset","grouped","numSeries","groupPadding","rectClass","barClass","barWidth","bars","cssClass","col","base","column","columnClass","rectStyle","dataKey","columnWidth","filteredData","cols","delay","validAlignmentClasses","classes","legend","vAlign","hAlign","Legend","firstChild","count","legendHeight","mid","positioner","selection","legendWidth","entries","rawData","seriesClassName","extras","renderPaths","startLine","line","animFn","animationsMap","animationDirection","shouldAnimate","startLineFn","partial","renderMarkers","animationDelay","marker","class","r","cx","cy","left-to-right","path","totalLength","getTotalLength","ease","bottom-to-top","normalizePadding","isNumber","pie","piePadding","clampBounds","maxWidth","maxHeight","calcPadding","resolveValueUnits","resolvePaddingUnits","group","arcTween","_current","arc","outerRadius","radius","innerRadius","startArc","startAngle","endAngle","pieData","attrTween","shouldCenterX","shouldCenterY","pixelPadding","referenceSize","totalPadding","proposedRadius","totalWidth","outerPaddingLeft","centerY","baseClass","sliceClass","translatePie","posY","pieGroup","ScatterPlot","scatter","halfRangeBand","stackTooltip","valueFormatter","classed","onMouseOver","isNull","mapFn","seriesName","filtered","html","onMouseOut","on","findOriginalDataPoint","seriesIndex","clearHideTimer","clearTimeout","hideTimer","changeOpacity","animate","tooltipElement","positionTooltip","alignedRight","pointOrCentroid","event","mouse","distance","parseFloat","pointX","pointY","clampPosition","show","hideTime","getTooltipText","allPoints","match","params","list","rest","response","first","formatters","dataPoints","showTime","normalizeDataSet","dataSet","isLinear","normalizer","regression","numericDomain","lineY"],"mappings":"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","sourcesContent":[null,"(function (undefined) {\n\n    var root = this;\n\n    if (typeof module === 'object' && module && typeof module.exports === 'object') {\n        if(typeof require === 'function') {\n            root.d3 = require('d3');\n            root._ = require('lodash');\n        }\n    }\n\n    if(!d3) throw new Error('You need to include d3.js before Contour. Go to http://d3js.org/');\n    if(!_ || !_.merge) throw new Error('You need to include lodash.js before Contour. Go to http://lodash.com/');\n\n})();\n","(function () {\n    // cheap trick to add decimals without hitting javascript issues\n    // note that this fails for very large numbers\n    var multiplier = function (x) { var dig = _.nw.decDigits(x); return dig === 0 ? 1 : Math.pow(10, dig); };\n    var maxMultiplier = function (a,b) { return Math.max(multiplier(a), multiplier(b)); };\n    var addFloat = function (a,b) { var factor = maxMultiplier(a,b), aa = a * factor, bb = b * factor; return (aa + bb) / factor; };\n    var subFloat = function (a,b) { var factor = maxMultiplier(a,b), aa = a * factor, bb = b * factor; return (aa - bb) / factor; };\n    var mulFloat = function (a,b) { var factor = maxMultiplier(a,b), aa = a * factor, bb = b * factor; return (aa * bb) / (factor*factor); };\n    var divFloat = function (a,b) { return +((a / b).toFixed(_.nw.digits(maxMultiplier(a,b)))); };\n\n    var noop = function () {};\n\n    var generalHelpers = {\n        // the src is a function returns the function evaluated\n        // otherwise returns src\n        getValue: function (src, deafult, ctx, args) {\n            args = Array.prototype.slice.call(arguments, 3);\n            return !src ? deafult : typeof src === 'function' ? src.apply(ctx, args) : src;\n        },\n\n        seriesNameToClass: function (name) {\n            return name || '';\n        }\n    };\n\n    var dataFilters = {\n\n        cleanNullValues: function () {\n            return function (series) {\n                return _.map(series, function (s) {\n                    return _.extend(s, {\n                        data: _.reduce(s.data, function (acum, datum) {\n                            if (datum.y != null) {\n                                acum.push(datum);\n                            }\n\n                            return acum;\n                        }, [])\n                    });\n                });\n            };\n        },\n\n        minMaxFilter: function (desiredLen) {\n            return function(data) {\n                if (data.length <= desiredLen)\n                    return data;\n\n                var toReturn = [data[0]]; //always want the first\n                var index = 1;\n                var increment = Math.floor(data.length / desiredLen);\n\n                while (index < data.length - 1) {\n                    var hasValidPt = false;\n                    var maxPt;\n                    var minPt;\n                    var maxIndex = Math.min(index + increment, data.length);\n\n                    for (var intermediateIndex = index; intermediateIndex < maxIndex; intermediateIndex++) {\n                        var intermediatePt = data[index];\n                        if (intermediatePt.y) {\n                            if (!hasValidPt || intermediatePt.y > maxPt.y)\n                                maxPt = intermediatePt;\n\n                            if (!hasValidPt || intermediatePt.y < minPt.y)\n                                minPt = intermediatePt;\n\n                            hasValidPt = true;\n                        }\n                    }\n\n                    if (hasValidPt) {\n                        if (minPt.x === maxPt.x) {\n                            toReturn.push(minPt);\n                        } else if (minPt.x < maxPt.x) {\n                            toReturn.push(minPt);\n                            toReturn.push(maxPt);\n                        } else if (minPt.x > maxPt.x) {\n                            toReturn.push(maxPt);\n                            toReturn.push(minPt);\n                        }\n                    }\n\n                    index += Math.max(1, Math.min(data.length - 1 - index, increment));\n                }\n                toReturn.push(data[data.length - 1]); //always want the last\n                return toReturn;\n            };\n        }\n    };\n\n    var logging = {\n        warn: function (msg) {\n            if (console && console.log)\n                console.log(msg);\n        }\n    };\n\n    var numberHelpers = {\n        firstAndLast: function (ar) {\n            return [ar[0], ar[ar.length-1]];\n        },\n\n        roundToNearest: function (number, multiple) {\n            return mulFloat(Math.ceil(divFloat(number, multiple)), multiple);\n        },\n\n        roundTo: function (value, digits) {\n            return divFloat(Math.ceil(mulFloat(value, Math.pow(10, digits))), Math.pow(10, digits));\n        },\n\n        trunc: function (value) {\n            return value - value % 1;\n        },\n\n        // only works for integers\n        digits: function (value) {\n            return value === 0 ? 1 : Math.floor(Math.log(Math.abs(value)) / Math.LN10) + 1;\n        },\n\n        decDigits: function (value) {\n            var parts = value.toString().split('.');\n            return parts.length < 2 ? 0 : parts[1].length;\n        },\n\n        log10: function (value) {\n            return Math.log(value) / Math.LN10;\n        },\n\n        clamp: function (val, l, h) {\n            return val > h ? h : val < l ? l : val;\n        },\n\n        clampLeft: function (val, low) {\n            return val < low ? low : val;\n        },\n\n        clampRight: function (val, high) {\n            return val > high ? high : val;\n        },\n\n        degToRad: function (deg) {\n            return deg * Math.PI / 180;\n        },\n\n        radToDeg: function (rad) {\n            return rad * 180 / Math.PI;\n        },\n\n        rotatePoint: function (point, rad) {\n            return {\n                x: point.x * Math.cos(rad) - point.y * Math.sin(rad),\n                y: point.x * Math.sin(rad) + point.y * Math.cos(rad)\n            };\n        },\n\n        translatePoint: function (point, delta) {\n            return {\n                x: point.x + delta.x,\n                y: point.y + delta.y\n            };\n        },\n\n        linearRegression: function (dataSrc) {\n            var lr = {};\n            var n = dataSrc.length;\n            var sum_x = 0;\n            var sum_y = 0;\n            var sum_xy = 0;\n            var sum_xx = 0;\n            var sum_yy = 0;\n\n            for (var i = 0; i < n; i++) {\n                sum_x += dataSrc[i].x;\n                sum_y += dataSrc[i].y;\n                sum_xy += (dataSrc[i].x*dataSrc[i].y);\n                sum_xx += (dataSrc[i].x*dataSrc[i].x);\n                sum_yy += (dataSrc[i].y*dataSrc[i].y);\n            }\n\n            lr.slope = (n * sum_xy - sum_x * sum_y) / (n*sum_xx - sum_x * sum_x);\n            lr.intercept = (sum_y - lr.slope * sum_x)/n;\n            lr.r2 = Math.pow((n*sum_xy - sum_x*sum_y)/Math.sqrt((n*sum_xx-sum_x*sum_x)*(n*sum_yy-sum_y*sum_y)),2);\n\n            return lr;\n        },\n\n        niceRound: function (val) {\n            // for now just round(10% above the value)\n            return Math.ceil(val + val * 0.10);\n\n            // var digits = Math.floor(Math.log(val) / Math.LN10) + 1;\n            // var fac = Math.pow(10, digits);\n\n            // if(val < 1) return _.nw.roundToNearest(val, 1);\n\n            // if(val < fac / 2) return _.nw.roundToNearest(val, fac / 2);\n\n            // return _.nw.roundToNearest(val, fac);\n        }\n    };\n\n    var axisHelpers = {\n        addAxis: function (name, axisCtor) {\n            _.nw.axes = _.nw.axes || {};\n            _.nw.axes[name] = axisCtor;\n        },\n\n        roundToNextTick: function (num) {\n            var abs = Math.abs(num);\n            var sign = abs === num ? 1 : -1;\n            var mag, step;\n            if (abs >= 1) {\n                mag = Math.floor(_.nw.log10(abs));\n                step = mag <= 1 ? 2 : Math.pow(10, mag - 1);\n            } else {\n\n                var exp = abs.toExponential().replace(/\\.|e-\\d+$/g, '');\n                mag = exp.length;\n                step = mulFloat((mag === 1 ? 2 : 10), Math.pow(10, -mag));\n            }\n\n            var raw = _.nw.roundToNearest(abs, step);\n            return sign * raw;\n        },\n\n        niceMinMax: function (min, max, ticks, startAtZero) {\n            // return divFloat(Math.ceil(mulFloat(value, Math.pow(10, digits))), Math.pow(10, digits));\n\n            var swap = false;\n            var origMax = max;\n            if (max < 0 && min < 0) {\n                max = -min;\n                min = -origMax;\n                swap = true;\n            }\n\n            var excelRoundUp = function (value, up) {\n                up = up != null ? up : 0;\n                var roundFn = function (v) { return v >= 0 ? Math.ceil(v) : Math.floor(v); };\n                return divFloat(roundFn(value * Math.pow(10, up)), Math.pow(10, up));\n            };\n            // 2 ticks seem to wokr for min max and passing 5 ticks to d3\n            ticks = ticks || 2;\n\n            startAtZero = min === 0 ? 1 : origMax < 0 ? 1 : 0;\n\n            // check for errors... min cannot be > max\n            if (min > max) {\n                return {\n                    min: min,\n                    max: min,\n                    tickValues: []\n                };\n            }\n\n            var a;\n            if (min === max) {\n                if (max === 0) {\n                    a = -1.0;\n                } else {\n                    a = numberHelpers.log10(Math.abs(max));\n                }\n            } else {\n                if(startAtZero) {\n                    a = numberHelpers.log10(Math.abs(max)) - 0.5;\n                } else {\n                    a = numberHelpers.log10(max-min) - 0.5;\n                }\n            }\n\n            var defaultRounding = -(a >= 0 ? numberHelpers.trunc(a) : Math.floor(a));\n\n            // var defaultRounding = -numberHelpers.trunc((min === max ?\n            //     max === 0 ? -1.0 : numberHelpers.log10(Math.abs(max)) :\n            //     startAtZero ? numberHelpers.log10(Math.abs(max)) : numberHelpers.log10(max-min)\n            // ) - 0.5);\n\n            var negativeMinAmount = excelRoundUp(Math.max(0, -min) / ticks, defaultRounding - 1);\n\n            var intermediateMax = min === max ? max === 0 ? 1 : excelRoundUp(max + negativeMinAmount, defaultRounding)\n                : excelRoundUp(max + negativeMinAmount,defaultRounding);\n\n            var iMin = 0;\n            if (!startAtZero && min !== max) {\n                var inter = min + negativeMinAmount;\n                var dig = numberHelpers.digits(inter);\n                var roundToDigits;\n                if (inter > 0) {\n                    roundToDigits =  -Math.floor(_.nw.log10(inter));\n                } else {\n                    roundToDigits = (Math.max(1, Math.abs(dig-2)));\n                }\n\n                iMin = -numberHelpers.roundTo(-inter, roundToDigits);\n                iMin = iMin === 0 ? 0 : iMin;\n                // old version:\n                // iMin = excelRound(min + negativeMinAmount, defaultRounding + (min < 0 ? 1 : 0))\n            }\n\n            var intermediateMin = iMin;\n\n            var interval = excelRoundUp(divFloat(subFloat(intermediateMax, intermediateMin),ticks), defaultRounding);\n            var finalMin = subFloat(intermediateMin, negativeMinAmount);\n            var finalMax = addFloat(finalMin, mulFloat(ticks, interval));\n            var ticksValues = [finalMin];\n            var prevTick = finalMin;\n\n            for (var j=1; j < ticks; j++) {\n                var newTick = addFloat(prevTick, interval);\n\n                ticksValues.push(newTick);\n                prevTick = newTick;\n            }\n\n            // total ticks are going to be either ticks or ticks + 1\n            if (Math.abs(prevTick - finalMax) > 1e-10) {\n                ticksValues.push(finalMax);\n            }\n\n            return {\n                min: swap ? -finalMax : finalMin,\n                max: swap ? - finalMin : finalMax,\n                tickValues: ticksValues.map(function (a) { return swap ? -a : a; })\n            };\n\n        },\n\n        /*jshint eqnull:true */\n        extractScaleDomain: function (domain, min, max, ticks, zeroAnchor) {\n            var dataMin = min != null ? min : _.min(domain);\n            var dataMax = max != null ? max : _.max(domain);\n\n            var niceMinMax = axisHelpers.niceMinMax(dataMin, dataMax, (ticks || 5), zeroAnchor);\n\n            return [niceMinMax.min, niceMinMax.max];\n\n            // // we want null || undefined for all this comparasons\n            // // that == null gives us\n            // if (min == null && max == null) {\n            //     return [niceMinMax.min, niceMinMax.max];\n            // }\n\n            // if (min == null) {\n            //     return [Math.min(niceMinMax.min, max), max];\n            // }\n\n            // if (max == null) {\n            //     return [min, Math.max(min, niceMinMax.max)];\n            // }\n\n            // return [min, max];\n        },\n\n        niceTicks: function (min, max, ticks, zeroAnchor) {\n            var niceMinMax = axisHelpers.niceMinMax(min, max, (ticks||5), zeroAnchor);\n            return niceMinMax.tickValues;\n        },\n\n        calcXLabelsWidths: function (ticks) {\n            var padding = 8;\n            return _.compact(ticks).map(String).map(function (d) {\n                if (!d) {\n                    return padding * 2;\n                }\n                return _.nw.textBounds(d, '.x.axis text').width + (padding * 2);\n            });\n        },\n\n        doXLabelsFit: function (ticks, labelFormatter, options) {\n            var tickWidths = _.nw.calcXLabelsWidths(ticks.map(labelFormatter));\n            var availableWidthForLabels = (options.chart.plotWidth + tickWidths[0] / 2 + tickWidths[ticks.length - 1] / 2);\n            var axisLabelsWidth = _.nw.sum(tickWidths);\n            return axisLabelsWidth <= availableWidthForLabels;\n        },\n\n        getTicksThatFit: function (ticks, labelFormatter, options) {\n            // reduce the number of ticks incrementally by taking every 2nd, then every 3th, and so on\n            // until we find a set of ticks that fits the available space\n            function reduceTicksByMod() {\n                var tickWidths = _.nw.calcXLabelsWidths(ticks.map(labelFormatter));\n                var axisLabelsWidth = _.nw.sum(tickWidths);\n                var availableWidthForLabels = (options.chart.plotWidth + tickWidths[0] / 2 + tickWidths[ticks.length - 1] / 2);\n                var iter = 1;\n                var filterMod = function (d, i) { return (i % iter) === 0; };\n                var finalTicks = ticks;\n                while(axisLabelsWidth > availableWidthForLabels && finalTicks.length !== 0) {\n                    iter++;\n                    finalTicks = _.filter(ticks, filterMod);\n                    axisLabelsWidth = _.nw.sum(_.nw.calcXLabelsWidths(finalTicks.map(labelFormatter)));\n                }\n\n                return finalTicks;\n            }\n\n            // possible alternative way using d3 ticks to calculate the number\n            // that fits\n            // function reduceTicksByD3() {\n            //     // while(axisLabelsWidth > availableWidthForLabels && ticks.length !== 1) {\n            //     //     ticks = axis.scale().ticks(Math.floor(--numAutoTicks));\n            //     //     axisLabelsWidth = sum(calcLabelsWidths(ticks.map(formatLabel)));\n            //     // }\n\n            //     // axis.ticks(ticks.length);\n            // }\n\n            return reduceTicksByMod();\n        }\n    };\n\n\n    var stringHelpers = {\n        // measure text inside a Contour chart container\n        textBounds: function (text, css) {\n            var body = document.getElementsByTagName('body')[0];\n            var wrapper = document.createElement('span');\n            var dummy = document.createElement('span');\n            wrapper.className = 'contour-chart';\n            dummy.style.position = 'absolute';\n            dummy.style.width = 'auto';\n            dummy.style.height = 'auto';\n            dummy.style.visibility = 'hidden';\n            dummy.style.lineHeight = '100%';\n            dummy.style.whiteSpace = 'nowrap';\n\n            dummy.innerHTML = text;\n            dummy.className = css.replace(/\\./g, ' ');\n            wrapper.appendChild(dummy);\n            body.appendChild(wrapper);\n            var res = { width: dummy.clientWidth, height: dummy.clientHeight };\n            wrapper.removeChild(dummy);\n            body.removeChild(wrapper);\n            return res;\n        }\n    };\n\n    var dateHelpers = {\n        dateDiff: function(d1, d2) {\n            var diff = d1.getTime() - d2.getTime();\n            return diff / (24*60*60*1000);\n        }\n    };\n\n    var arrayHelpers = {\n        // concatenate and sort two arrays to the resulting array\n        // is sorted ie. merge [2,4,6] and [1,3,5] = [1,2,3,4,5,6]\n        merge: function (array1, array2) {\n            if(typeof(array1) === 'number') array1 = [array1];\n            if(typeof(array2) === 'number') array2 = [array2];\n            if(!array1 || !array1.length) return array2;\n            if(!array2 || !array2.length) return array1;\n\n            return [].concat(array1, array2).sort(function (a,b) { return a-b; });\n        },\n\n        isCorrectDataFormat: function (dataArray) {\n            return _.isArray(dataArray) && _.all(dataArray, function (p) { return p.hasOwnProperty('x') && p.hasOwnProperty('y'); });\n        },\n\n        isCorrectSeriesFormat: function (data) {\n            var isArrayOfObjects = _.isArray(data) && _.isObject(data[0]);\n            var hasDataArrayPerSeries = _.all(data, function (d) { return d.hasOwnProperty('data'); });\n            var hasSeriesNamePerSeries = _.all(data, function (d) { return d.hasOwnProperty('name'); });\n            var datumInCorrectFormat = isArrayOfObjects && hasDataArrayPerSeries && arrayHelpers.isCorrectDataFormat(data[0].data);\n\n            return isArrayOfObjects && hasDataArrayPerSeries && hasSeriesNamePerSeries && datumInCorrectFormat;\n        },\n\n        /*jshint eqnull:true */\n        // we are using != null to get null & undefined but not 0\n        normalizeSeries: function (data, categories) {\n            var hasCategories = !!(categories && _.isArray(categories));\n            function sortFn(a, b) { return a.x - b.x; }\n            function normal(set, name) {\n                var d = {\n                    name: name,\n                    data: _.map(set, function (d, i) {\n                        var hasX = d != null && d.hasOwnProperty('x');\n                        var val = function (v) { return v != null ? v : null; };\n                        // make sure we return a valid category and not cast nulls as string\n                        var categoryAt = function (i) { return !hasCategories ? i : categories[i] == null ? null : categories[i] + ''; };\n                        return hasX ? _.extend(d, { x: d.x, y: val(d.y) }) : { x: categoryAt(i), y: val(d) };\n                    })\n                };\n\n                if (!hasCategories) {\n                    d.data.sort(sortFn);\n                }\n\n                return d;\n            }\n\n            var correctDataFormat = arrayHelpers.isCorrectDataFormat(data);\n            var correctSeriesFormat = arrayHelpers.isCorrectSeriesFormat(data);\n\n            // do not make a new copy, if the data is already in the correct format!\n            if (correctSeriesFormat) {\n                return data;\n            }\n\n            // do the next best thing if the data is a set of points in the correct format\n            if (correctDataFormat) {\n                if (!hasCategories) data.sort(sortFn);\n                return [{ name: 'series 1', data: data }];\n            }\n\n            // for the rest of the cases we need to normalize to the full format of the series\n            if (_.isArray(data)) {\n                if ((_.isObject(data[0]) && data[0].hasOwnProperty('data')) || _.isArray(data[0])) {\n                    // this would be the shape for multiple series\n                    return _.map(data, function (d, i) { return normal(d.data ? d.data : d, d.name ? d.name : 'series ' + (i+1)); });\n                } else {\n                    // this is just the shape [1,2,3,4] or [{x:0, y:1}, { x: 1, y:2}...]\n                    return [normal(data, 'series 1')];\n                }\n            }\n\n            // nothing to do to the data if it's not in a supported format\n            return data;\n        },\n\n        // returns a function to format the data into a 'stacked' d3 layout\n        // passing in a series data will add a y0 to each data point\n        // where the point should start relative to the reset of the series points\n        // at that x value\n        stackLayout: function () {\n            var stack = d3.layout\n                .stack()\n                .values(function (d) { return d.data; });\n            // prepare satck to handle different x values with different lengths\n            var outFn = function() {\n                var y0s = {};\n                return function (d, y0, y) {\n                    d.y0 = y0s[d.x] != null ? y0s[d.x] : 0;\n                    d.y = y;\n                    y0s[d.x] = (y0s[d.x] || 0) + y;\n                };\n            };\n\n            stack.out(outFn());\n\n            return stack;\n        },\n\n        // return the uniq elements in the array\n        // we are implementing our own version since this algorithm seems\n        // to be a lot faster than what lodash uses\n        uniq: function (array) {\n            var cache = {}, result = [];\n            var len = array.length;\n\n            for (var j=0; j<len; j++) {\n                var el = array[j], key = el + '';\n\n                if (!cache.hasOwnProperty(key)) {\n                    cache[key] = true;\n                    result.push(el);\n                }\n            }\n\n            return result;\n        },\n\n        sum: function (array) {\n            return _.reduce(array, function (acc, cur) { return acc += cur; }, 0);\n        },\n\n        maxTickValues: function (max, domain) {\n            var len = domain.length;\n            var values = [];\n\n            if (max >= len) return domain.slice();\n\n            // return d3.scale.linear().domain(domain).ticks(max);\n\n            var tickInteval = Math.ceil((len) / (max));\n            var cur = 0;\n            while (cur < len) {\n                values.push(domain[cur]);\n                cur += tickInteval;\n            }\n\n            return values;\n        },\n\n        isSupportedDataFormat: function (data) {\n            // this covers all supported formats so far:\n            // [ {data: [...] }, ... ]\n            // [ [...], [...] ]\n            return _.isArray(data) &&\n                (_.isObject(data[0]) && data[0].hasOwnProperty('data') && _.isArray(data[0].data)) ||\n                _.isArray(data[0]);\n        }\n\n    };\n\n    var domHelpers = {\n        selectDom: function (selector) {\n            return d3.select(selector)[0][0];\n        },\n\n        getStyle: function (el, style) {\n            if(!el) return undefined;\n            var elem = typeof el === 'string' ? this.selectDom(el) : el;\n            // we need a good way to check if the element is detached or not\n            var styles = elem.offsetParent ? elem.ownerDocument.defaultView.getComputedStyle(elem, null) : elem.style;\n\n            return style ? styles[style] : styles;\n        },\n\n        getCentroid: function (element) {\n            var getOffsetParent = function () {\n                if (element.offsetParent) {\n                    return element.offsetParent;\n                }\n\n                // we we don't have an offsetParent, we may be in firefox\n                // let's just assume that the offset parent is the svg element\n                var t = element;\n                while(t && t.tagName !== 'svg') {\n                    t = t.parentNode;\n                }\n\n                return t;\n            };\n\n            var parentBox = getOffsetParent().getBoundingClientRect();\n            var bbox = element.getBoundingClientRect();\n\n            return [bbox.left - parentBox.left + bbox.width/2, bbox.top - parentBox.top + bbox.height/2];\n        }\n    };\n\n    var debuggingHelpers = {\n        warning: function (msg) {\n            if(console && console.log) {\n                console.log('WARNING: ' + msg);\n            }\n        }\n    };\n\n    _.nw = _.extend({}, _.nw, numberHelpers, arrayHelpers, stringHelpers, dateHelpers,\n        axisHelpers, debuggingHelpers, domHelpers, generalHelpers, logging, dataFilters);\n\n    if (!_.noop) {\n        _.noop = noop;\n    }\n\n})();\n","(function () {\n\n    var root = this;\n\n    var defaults = {\n\n        chart: {\n            animations: {\n                enable: true,\n                // duration of the animation in ms\n                duration: 400,\n            },\n            // by default take the size of the parent container\n            defaultWidth: 400,\n            // height = width * ratio\n            defaultAspect: 1 / 1.61803398875,\n            // calculated at render time based on the options & container\n            width: undefined,\n            // if defined, height takes precedence over aspect\n            height: undefined,\n            // margin between the container and the chart (ie labels or axis title)\n            margin: {\n                top: 0,\n                right: 0,\n                bottom: 0,\n                left: 0\n            },\n            // padding between the chart area and the inner plot area */\n            padding: {\n                top: null,\n                right: null,\n                bottom: null,\n                left: null\n            },\n            internalPadding: {\n                bottom: 0,\n                left: 0\n            },\n            // automatically false by default anyway; adding here to help generate docs\n            rotatedFrame: false,\n            // width in pixels of the plot area (area inside the axis if any). This gets calculated on render\n            plotWidth: undefined,\n            // height in pixels of the plot area (area inside the axis if any). This gets calculated on render\n            plotHeight: undefined,\n            // top edge in pixels (from the edge of the svg) of the plot area (area inside the axis if any). This gets calculated on render\n            plotTop: undefined,\n            // left edge in pixels (from the edge of the svg) of the plot area (area inside the axis if any). This gets calculated on render\n            plotLeft: undefined,\n        },\n\n        xAxis: {\n        },\n\n        yAxis: {\n        },\n\n        tooltip: {\n        }\n    };\n\n    // used to pass the last specified dataset\n    // to the next visualiaztion in the chain wihtout\n    // the need to specify it again.... this allows you to do\n    // new Contour().cartesian().line(dataset).lengend().tooltip().render()\n    // and legend and tooltip will recieve dataset\n    var lastData;\n\n    /**\n    * Creates a Contour instance, based on the core Contour visualizations object. This instance can contain a set of related visualizations.\n    *\n    *   * Pass the constructor any configuration options in the *options* parameter. Make sure the `el` option contains the selector of the container in which the Contour instance will be rendered.\n    *   * Set the frame for this Contour instance (e.g. `.cartesian()`).\n    *   * Add one or more specific visualizations to this Contour instance (e.g. `.scatter()`, `.trend-line()`). Pass each visualization constructor the data it displays. Pass configuration options if desired.\n    *   * Invoke an action for this Contour instance (e.g. `.render()`).\n    *\n    * ### Example:\n    *\n    *     new Contour({el: 'myChart'})\n    *       .cartesian()\n    *       .line([1,3,2,5])\n    *       .render()\n    *\n    *\n    * @class Contour()\n    * @param {object} options The global configuration options object\n    *\n    */\n    function Contour (options) {\n        this.init(options);\n\n        return this;\n    }\n\n    /**\n    * Adds a new kind of visualization to the core Contour object.\n    * The *renderer* function is called when you add this visualization to instances of Contour.\n    * See a sample in the [Contour Gallery](http://forio.com/contour/gallery.html#/chart/pie/pie-gauge).\n    *\n    * ### Example:\n    *\n    *     Contour.export(\"exampleVisualization\", function(data, layer) {\n    *           //function body to create exampleVisualization\n    *           //for example using SVG and/or D3\n    *     });\n    *\n    *     //to include the visualization into a specific Contour instance\n    *     new Contour(options)\n    *           .exampleVisualization(data)\n    *           .render()\n    *\n    * @param {String} ctorName Name of the visualization, used as a constructor name.\n    * @param {Function} renderer Function called when this visualization is added to a Contour instance. This function receives the data that is passed in to the constructor.\n    */\n    Contour.export = function (ctorName, renderer) {\n\n        if (typeof renderer !== 'function') throw new Error('Invalid render function for ' + ctorName + ' visualization');\n\n        function sortSeries(data) {\n            if(!data || !data.length) return [];\n\n            if(data[0].data) {\n                _.each(data, sortSeries);\n            }\n\n            var shouldSort = _.isObject(data[0]) && _.isDate(data[0].x);\n            var sortFunc = function (a, b) { return a.x - b.x; };\n            if(shouldSort) {\n                data.sort(sortFunc);\n            }\n\n            return data;\n        }\n\n        Contour.prototype[ctorName] = function (data, options) {\n            var categories = this.options ? this.options.xAxis ? this.options.xAxis.categories : undefined : undefined;\n            var opt =  _.extend({}, this.options[ctorName], options);\n            var vis;\n            var ownData = true;\n\n            if (!data) {\n                data = lastData || [];\n                ownData = false;\n            }\n\n            sortSeries(data);\n            vis = new Contour.VisualizationContainer(data, categories, opt, ctorName, renderer, this);\n            vis.ownData = ownData;\n            this._visualizations.push(vis);\n            lastData = data;\n            return this;\n        };\n\n        /* expose the renderer function so it can be reused\n        * by other visualizations though the constructor function\n        * ie. Contour.export('customLineChart', function (data, layer, options) {\n        *       // call the line chart directly\n        *       return this.line.renderer(data, layer, options);\n        *    });\n        */\n        Contour.prototype[ctorName].renderer = renderer;\n    };\n\n\n    /**\n    * Exposes functionality to the core Contour object.\n    * Use this to add *functionality* that will be available for any visualizations.\n    *\n    * ###Example:\n    *\n    *     Contour.expose('example', function ctor(params) {\n    *         // params are the parameters passed into the constructor function\n    *         return {\n    *             // the init function, if provided, is called automatically upon instantiation of the functionality\n    *             // the options parameter has the global Contour options object\n    *             init: function (options) { ... },\n    *\n    *             // when included in the instance, the function `.myFunction` is available in the visualizations\n    *             myFunction: function(data) { .... }\n    *         };\n    *     });\n    *\n    *     Contour.export('visualizationThatUsesMyFunction', function(data, layer) {\n    *           //function body including call to this.myFunction(data)\n    *     });\n    *\n    *     // to include the functionality into a specific instance\n    *     new Contour(options)\n    *           .example({ text: 'someText' })\n    *           .visualizationThatUsesMyFunction()\n    *           .render()\n    *\n\n    */\n    Contour.expose = function (ctorName, functionalityConstructor) {\n        var ctor = function () {\n            var functionality = functionalityConstructor;\n            if (typeof functionalityConstructor === 'function') {\n                functionality = Object.create(functionalityConstructor);\n                functionality = functionalityConstructor.apply(functionality, arguments);\n            }\n\n            // extend the --instance-- we don't want all charts to be overriden...\n            _.extend(this, _.omit(functionality, 'init'));\n\n            if(functionality.init) {\n                functionality.init.call(this, this.options);\n            }\n\n            // keep a list of the included functionality into this instance\n            // so we can match and check dependencies\n            this._exposed.push(ctorName);\n\n            return this;\n        };\n\n        Contour.prototype[ctorName] = ctor;\n\n        return this;\n    };\n\n    Contour.prototype = _.extend(Contour.prototype, {\n        _visualizations: undefined,\n\n        _extraOptions: undefined,\n\n        _exposed: undefined,\n\n        // Initializes the instance of Contour\n        init: function (options) {\n            // for now, just  store this options here...\n            // the final set of options will be composed before rendering\n            // after all components/visualizations have been added\n            this.options = options || {};\n\n            this._extraOptions = [];\n            this._visualizations = [];\n            this._exposed = [];\n\n            return this;\n        },\n\n        calculateWidth: function () {\n\n            // assume all in pixel units and border-box box-sizing\n            var outerWidth = parseInt(_.nw.getStyle(this.options.el, 'width') || 0, 10);\n            var paddingLeft = parseInt(_.nw.getStyle(this.options.el, 'padding-left') || 0, 10);\n            var paddingRight = parseInt(_.nw.getStyle(this.options.el, 'padding-right') || 0, 10);\n\n            var width = outerWidth - paddingRight - paddingLeft;\n\n            return this.options.el ? (width || this.options.chart.defaultWidth) : this.options.chart.defaultWidth;\n        },\n\n        calculateHeight: function () {\n            // assume all in pixel units and border-box box-sizing\n            var outerHeight = parseInt(_.nw.getStyle(this.options.el, 'height') || 0, 10);\n            var paddingTop = parseInt(_.nw.getStyle(this.options.el, 'padding-top') || 0, 10);\n            var paddingBottom = parseInt(_.nw.getStyle(this.options.el, 'padding-bottom') || 0, 10);\n            var height = outerHeight - paddingTop - paddingBottom;\n\n            var containerHeight = this.options.el ? height : undefined;\n            var calcWidth = this.options.chart.width;\n            var ratio = this.options.chart.aspect || this.options.chart.defaultAspect;\n\n            return !!containerHeight && containerHeight > 1 ?  containerHeight : Math.round(calcWidth * ratio);\n        },\n\n        calcMetrics: function () {\n            var options = this.options;\n\n            this.adjustPadding();\n\n            this.adjustTitlePadding();\n\n            options.chart.width = options.chart.width || this.calculateWidth();\n            options.chart.height = options.chart.height || this.calculateHeight();\n\n            this.options = _.merge(options, {\n                chart: {\n                    plotWidth: options.chart.width - options.chart.margin.left - options.chart.margin.right - options.chart.internalPadding.left - options.chart.padding.right,\n                    plotHeight: options.chart.height - options.chart.margin.top - options.chart.margin.bottom - options.chart.padding.top - options.chart.internalPadding.bottom,\n                    plotLeft: options.chart.margin.left + options.chart.internalPadding.left,\n                    plotTop: options.chart.margin.top + options.chart.padding.top\n                }\n            });\n\n            if (this.options.chart.plotWidth <= 0 || this.options.chart.plotHeight <= 0) {\n                console.warn('The chart has no space to render. Either the width/height is zero or you have too much padding\\nWidth: ' + options.chart.width +\n                    '\\nHeight: ' + options.chart.height +\n                    '\\npadding-left: ' + options.chart.padding.left +\n                    '\\npadding-right: ' + options.chart.padding.right +\n                    '\\npadding-top: ' + options.chart.padding.top +\n                    '\\npadding-bottom: ' + options.chart.padding.bottom);\n\n                this.options.chart.plotWidth = this.options.chart.plotWidth < 0 ? 0 : this.options.chart.plotWidth;\n                this.options.chart.plotHeight = this.options.chart.plotHeight < 0 ? 0 : this.options.chart.plotHeight;\n            }\n        },\n\n        adjustPadding: function () {\n            // overriden by components that need to adjust padding\n            return this;\n        },\n\n        adjustTitlePadding: function () {\n            // overriden by components that need to adjust padding\n            return this;\n        },\n\n        composeOptions: function () {\n            var allDefaults = _.merge({}, defaults);\n            var mergeExtraOptions = function (opt) { _.merge(allDefaults, opt); };\n            var mergeDefaults = function (vis) { _.merge(allDefaults, vis.renderer.defaults); };\n\n            _.each(this._extraOptions, mergeExtraOptions);\n            _.each(this._visualizations, mergeDefaults);\n\n            // compose the final list of options right before start rendering\n            this.options = _.merge(this.options, _.merge({}, allDefaults, this.options));\n        },\n\n        baseRender: function () {\n            this.plotArea();\n\n            return this;\n        },\n\n        /**\n        * Renders this Contour instance and all its visualizations into the DOM.\n        *\n        * ### Example:\n        *\n        *     new Contour({ el:'.myChart' })\n        *           .pie([1,2,3])\n        *           .render();\n        *\n        * @function render\n        *\n        */\n        render: function () {\n            this.composeOptions();\n\n            this.calcMetrics();\n\n            this.baseRender();\n\n            this.renderVisualizations();\n\n            return this;\n        },\n\n        /**\n        * Clears this Contour instance and all its visualizations of any size information, so that on the next call to `render()` the instance is re-measured.\n        *\n        * The function takes two optional arguments `width` and `height`. If given a specific width/height the chart uses that sizing information on the next render.\n        *\n        * ### Example:\n        *\n        *     var contour = new Contour({ el:'.myChart' })\n        *           .pie([1,2,3])\n        *           .render();\n        *\n        *     var onResize = function(e) {\n        *          contour.resize().render();\n        *     }\n        *\n        *     window.addEventListener('resize', onResize);\n        *\n        * @function resize\n        * @param {Number} width (optional) The new width for the visualizations. If left blank, the width will be calcuated from options.el's parent.\n        * @param {Number} height (optional) The new height for the visualizations. If left blank, the height will be calcuated from options.el's parent.\n        */\n        resize: function(width, height) {\n\n            if (this.container)\n                this.container.style('height', 0);\n\n            delete this.options.chart.width;\n            delete this.options.chart.height;\n            delete this.options.chart.plotWidth;\n            delete this.options.chart.plotHeight;\n            delete this.options.chart.plotLeft;\n            delete this.options.chart.plotTop;\n\n            if (width)\n                this.options.chart.width = width;\n\n            if (height)\n                this.options.chart.height = height;\n            return this;\n        },\n\n        update: function () {\n            this.calcMetrics();\n            return this;\n        },\n\n        plotArea: function () {\n\n            var chartOpt = this.options.chart;\n\n            this.container = d3.select(this.options.el);\n            // fix a flicker im web-kit when animating opacity and the chart is in an iframe\n            this.container.attr('style', '-webkit-backface-visibility: hidden; position: relative');\n\n            if(!this.svg) {\n                this.svg = this.container\n                    .append('svg')\n                    .attr('viewBox', '0 0 ' + chartOpt.width + ' ' + chartOpt.height)\n                    .attr('preserveAspectRatio', 'xMinYMin')\n                    .attr('class', 'contour-chart')\n                    .attr('height', chartOpt.height)\n                    .append('g')\n                        .attr('transform', 'translate(' + chartOpt.margin.left + ',' + chartOpt.margin.top + ')');\n            } else {\n                this.svg\n                    .attr('transform', 'translate(' + chartOpt.margin.left + ',' + chartOpt.margin.top + ')');\n\n                d3.select(this.svg.node().parentNode)\n                    .attr('viewBox', '0 0 ' + chartOpt.width + ' ' + chartOpt.height)\n                    .attr('height', chartOpt.height);\n            }\n\n            return this;\n        },\n\n        createVisualizationLayer: function (vis, id) {\n            return this.svg.append('g')\n                .attr('vis-id', id)\n                .attr('vis-type', vis.type);\n        },\n\n        renderVisualizations: function () {\n\n            _.each(this._visualizations, function (visualization, index) {\n                var id = index + 1;\n                var layer = visualization.layer || this.createVisualizationLayer(visualization, id);\n                var opt = _.merge({}, this.options, visualization.options);\n\n                layer.attr('transform', 'translate(' + this.options.chart.internalPadding.left + ',' + (this.options.chart.padding.top || 0) + ')');\n\n                visualization.layer = layer;\n                visualization.parent = this;\n                visualization.render(layer, opt, this);\n            }, this);\n\n            return this;\n        },\n\n        /**\n        * Assert that all the dependencies are in the Contour instance.\n        * For example, if a visualization requires Cartesian to be included in the instance,\n        * it could call this.checkDependencies('Cartesian'), and the framework would\n        * give a helpful error message if Cartesian was not included.\n        *\n        * @function checkDependencies\n        * @param {string|array} list of dependencies (as specified in the instance constructor)\n        *\n        */\n        checkDependencies: function (listOfDependencies) {\n            listOfDependencies = _.isArray(listOfDependencies) ? listOfDependencies : [listOfDependencies];\n            var _this = this;\n            var missing = [];\n\n            _.each(listOfDependencies, function (dep) {\n                if (_this._exposed.indexOf(dep) === -1) {\n                    missing.push(dep);\n                }\n            });\n\n            if (missing.length) {\n                throw new Error('ERROR: Missing depeendencies in the Contour instance (ej. new Contour({}).cartesian())\\n The missing dependencies are: [' + missing.join(', ') + ']\\nGo to http://forio.com/contour/documentation.html#key_concepts for more information');\n            }\n        },\n\n        ensureDefaults: function (options, renderer) {\n            if (_.isString(renderer)) {\n                renderer = this[renderer].renderer;\n            }\n\n            if (renderer.defaults) {\n                var defaults = renderer.defaults;\n                options = _.defaults(options || {}, defaults);\n                this.options = _.defaults(this.options, defaults);\n            }\n        },\n\n        /**\n        * Sets the same data into all visualizations for a Contour instance. Useful for creating interactive\n        * visualizations: call after getting the additional data from the user.\n        *\n        * ###Example:\n        *\n        *     var data = [1,2,3,4,5];\n        *     var chart = new Contour({ el:'.myChart' })\n        *           .cartesian()\n        *           .scatter(data)\n        *           .trendLine(data);\n        *\n        *     data.push(10);\n        *     chart.setData(data)\n        *           .render();\n        *\n        * @function setData\n        *\n        */\n        setData: function (data) {\n            _.invoke(this._visualizations, 'setData', data);\n\n            return this;\n        },\n\n        /**\n        * Returns a VisualizationContainer object for the visualization at a given index (0-based).\n        *\n        * ###Example:\n        *\n        *     var chart = new Contour({ el:'.myChart' })\n        *           .pie([1,2,3])\n        *           .render();\n        *\n        *     var myPie = chart.select(0);\n        *\n        *     // do something with the visualization, for example updating its data set\n        *     myPie.setData([6,7,8,9]).render();\n        *\n        * @function select\n        *\n        */\n        select: function (index) {\n            return this._visualizations[index];\n        },\n\n        // place holder function for now\n        data: function () {\n\n        },\n\n        dataNormalizer: _.nw.normalizeSeries,\n\n        isSupportedDataFormat: _.nw.isSupportedDataFormat\n    });\n\n    // exports for commonJS and requireJS styles\n    if (typeof module === 'object' && module && typeof module.exports === 'object') {\n        module.exports = Contour;\n    } else {\n        root.Contour = Contour;\n        if (typeof define === 'function' && define.amd) {\n            define('contour', [], function () { return Contour; });\n        }\n    }\n\n})();\n","(function () {\n\n    var YAxis = function (data, options, domain) {\n        this.data = data;\n        this.options = options;\n        this.domain = domain;\n    };\n\n    function setRange(scale, options) {\n        var rangeSize = options.chart.rotatedFrame ? options.chart.plotWidth : options.chart.plotHeight;\n        var range = options.chart.rotatedFrame ? [0, rangeSize] : [rangeSize, 0];\n        return scale.range(range);\n    }\n\n    YAxis.prototype = {\n        axis: function () {\n            /*jshint eqnull:true */\n            var options = this.options.yAxis;\n            var domain = this.domain;\n            var dMin = options.min != null ? options.min : options.zeroAnchor ? Math.min(0, domain[0]) : domain[0];\n            var dMax = options.max != null ? options.max : domain[1];\n            var tickValues = options.tickValues || _.nw.niceTicks(dMin, dMax, options.ticks);\n            var numTicks = this.numTicks(domain, options.min, options.max);\n            var format = options.labels.formatter || d3.format(options.labels.format);\n\n            return d3.svg.axis()\n                .scale(this._scale)\n                .tickFormat(format)\n                .tickSize(options.innerTickSize, options.outerTickSize)\n                .tickPadding(options.tickPadding)\n                .ticks(numTicks)\n                .tickValues(tickValues);\n        },\n\n        scale: function (domain) {\n            if(!this._scale) {\n                this._scale = d3.scale.linear();\n                this.setDomain(domain);\n            }\n\n            setRange(this._scale, this.options);\n            return this._scale;\n        },\n\n        setDomain: function (domain) {\n            this._scale.domain(domain);\n            this._niceTheScale();\n            return this._scale;\n        },\n\n        update: function (domain, dataSrc) {\n            this.data = dataSrc;\n            this.setDomain(domain);\n            this.scale();\n        },\n\n        /*jshint eqnull:true*/\n        numTicks: function () {\n            return this.options.yAxis.ticks != null ? this.options.yAxis.ticks : undefined;\n        },\n\n        _niceTheScale: function () {\n            // nothing to do for the regular y-axis\n        }\n    };\n\n    _.nw.addAxis('YAxis', YAxis);\n\n})();\n","(function () {\n    /*jshint eqnull:true */\n    var defaults = {\n        chart: {\n            gridlines: 'none',\n            padding: {\n                top: 6,\n                right: 5,\n                // this get's defined based on the axis & title\n                bottom: undefined,\n                // this get's defined based on the axis & title\n                left: undefined\n            }\n        },\n\n        xAxis: {\n            // type of axis {ordinal|linear|time}\n            type: null, // default is linear in line.js (needs to be null here so overrides work)\n            categories: undefined,\n            max: undefined,\n            min: undefined,\n            innerTickSize: 6,\n            outerTickSize: 0,\n            tickPadding: 6,\n            maxTicks: undefined,\n            ticks: undefined,\n            tickValues: undefined,\n            title: undefined,\n            titlePadding: 4,\n            // padding between ranges (ie. columns) expressed in percentage of rangeBand width\n            innerRangePadding: 0.1,\n            // padding between all ranges (ie. columns) and the axis (left & right) expressed in percentage of rangeBand width\n            outerRangePadding: 0.1,\n            firstAndLast: false,\n            orient: 'bottom',\n            labels: {\n                format: undefined,\n                formatter: undefined\n            },\n            linearDomain: false,     // specify if a time domain should be treated linearly or ....\n        },\n\n        yAxis: {\n            // @param: {linear|smart|log}\n            // type: 'smart',\n            min: undefined,\n            max: undefined,\n            zeroAnchor: true,\n            smartAxis: false,\n            innerTickSize: 6,\n            outerTickSize: 6,\n            tickPadding: 4,\n            tickValues: undefined,\n            ticks: undefined,\n            title: undefined,\n            titlePadding: 4,\n            orient: 'left',\n            labels: {\n                // top, middle, bottom\n                verticalAlign: 'middle',\n                format: 's', // d3 formats\n                formatter: undefined // a function that formats each value ie. function (datum) { return 'x: ' + datum.x + ', y:' + datum.y }\n            }\n        }\n    };\n\n\n    /**\n    * Provides a Cartesian frame to the Contour instance.\n    *\n    * This is required for all visualizations displayed in a Cartesian frame, for example line charts, bar charts, area charts, etc. It is not required otherwise; for instance, pie charts do not use a Cartesian frame.\n    *\n    * ###Example:\n    *\n    *     new Contour(options)\n    *           .cartesian();\n    *\n    * @name cartesian\n    */\n    var cartesian = function () {\n        var maxTickSize = function (options) { return Math.max(options.outerTickSize || 0, options.innerTickSize || 0); };\n        return {\n            dataSrc: [],\n\n            init: function (options) {\n\n                // readonly properties (ie. user cannot modify)\n                var readOnlyProps = {\n                    chart: {\n                        rotatedFrame: false,\n                        internalPadding: {\n                            bottom: undefined,\n                            left: undefined\n                        }\n                    }\n                };\n\n                this.options = options || {};\n\n                _.merge(this.options, readOnlyProps);\n\n                var extraPadding = {};\n                if (!this.options.xAxis || !this.options.xAxis.firstAndLast) {\n                    extraPadding = { chart : { padding: { right: 15 }}};\n                }\n\n                this._extraOptions.push(_.merge({}, defaults, extraPadding));\n\n                return this;\n            },\n\n            xDomain: [],\n            yDomain: [],\n\n            _getYScaledDomain: function (domain, options) {\n                var absMin = options.yAxis.zeroAnchor && domain && domain[0] > 0 ? 0 : undefined;\n                var min = options.yAxis.min != null ? options.yAxis.min : absMin;\n\n                if (options.yAxis.tickValues) {\n                    if (options.yAxis.min != null && options.yAxis.max != null) {\n                        return [options.yAxis.min, options.yAxis.max];\n                    } else if (options.yAxis.min != null) {\n                        return [options.yAxis.min, d3.max(options.yAxis.zeroAnchor ? [0].concat(options.yAxis.tickValues) : options.yAxis.tickValues)];\n                    } else if (options.yAxis.max != null) {\n                        return [d3.min(options.yAxis.zeroAnchor ? [0].concat(options.yAxis.tickValues) : options.yAxis.tickValues), options.yAxis.max];\n                    } else {\n                        return d3.extent(options.yAxis.zeroAnchor || options.yAxis.min != null ? [min].concat(options.yAxis.tickValues) : options.yAxis.tickValues);\n                    }\n                } else if (options.yAxis.smartAxis) {\n                    return d3.extent(options.yAxis.zeroAnchor || options.yAxis.min != null ? [min].concat(domain) : domain);\n                }\n\n                return _.nw.extractScaleDomain(domain, min, options.yAxis.max, options.yAxis.ticks);\n            },\n\n            /*jshint eqnull:true */\n            adjustPadding: function () {\n                var xOptions = this.options.xAxis;\n                var yOptions = this.options.yAxis;\n                // bottom padding calculations\n                if (this.options.chart.padding.bottom == null) {\n                    this.options.chart.internalPadding.bottom = this._getAdjustedBottomPadding(xOptions);\n                } else {\n                    this.options.chart.internalPadding.bottom = this.options.chart.padding.bottom || 0;\n                }\n\n                this.options.chart.padding.top = this.options.chart.internalPadding.top = this._getAdjustedTopPadding(xOptions);\n\n                // left padding calculations\n                if (this.options.chart.padding.left == null) {\n                    this.options.chart.internalPadding.left = this._getAdjustedLeftPadding(yOptions);\n                } else {\n                    this.options.chart.internalPadding.left = this.options.chart.padding.left;\n                }\n\n                this.options.chart.padding.right = this.options.chart.internalPadding.right = this._getAdjustedRightPadding(yOptions);\n            },\n\n            _getAdjustedTopPadding: function (options) {\n                return this.options.chart.padding.top;\n            },\n\n            _getAdjustedBottomPadding: function (options) {\n                if (options.ticks !== 0) {\n                    var xLabels = this.xDomain;\n                    var xAxisText = xLabels.join('<br>');\n                    var xLabelBounds = _.nw.textBounds(xAxisText, '.x.axis');\n                    var regularXBounds = _.nw.textBounds('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890', '.x.axis');\n                    var em = regularXBounds.height;\n                    var ang = options.labels && options.labels.rotation ? options.labels.rotation % 360 : 0;\n                    var xLabelHeightUsed = ang === 0 ? regularXBounds.height : Math.ceil(Math.abs(xLabelBounds.width * Math.sin(_.nw.degToRad(ang))) + em / 5) ;\n                    return maxTickSize(options) + (options.tickPadding || 0) +\n                        xLabelHeightUsed;\n                } else {\n                    return maxTickSize(options) + (options.tickPadding || 0);\n                }\n            },\n\n            _getAdjustedLeftPadding: function (options) {\n                var yDomainScaled = this._getYScaledDomain(this.yDomain, this.options);\n                var tmpScale = d3.scale.linear().domain(yDomainScaled);\n                var yLabels = tmpScale.ticks(options.ticks);\n\n                var format = options.labels.formatter || d3.format(options.labels.format || ',.0f');\n                var yAxisText = _.map(yLabels, format).join('<br>');\n                var yLabelBounds = _.nw.textBounds(yAxisText, '.y.axis');\n                return maxTickSize(this.options.yAxis) + (this.options.yAxis.tickPadding || 0) +\n                    yLabelBounds.width;\n            },\n\n            _getAdjustedRightPadding: function (options) {\n                return this.options.chart.padding.right;\n            },\n\n            adjustTitlePadding: function () {\n                var titleBounds;\n                if (this.options.xAxis.title || this.options.yAxis.title) {\n                    if(this.options.xAxis.title) {\n                        titleBounds = _.nw.textBounds(this.options.xAxis.title, '.x.axis-title');\n                        this.options.chart.internalPadding.bottom += titleBounds.height + this.options.xAxis.titlePadding;\n                    }\n\n                    if(this.options.yAxis.title) {\n                        titleBounds = _.nw.textBounds(this.options.yAxis.title, '.y.axis-title');\n                        this.options.chart.internalPadding.left += titleBounds.height + this.options.yAxis.titlePadding;\n                    }\n                }\n            },\n\n            computeXScale: function () {\n                if (!this.xDomain) throw new Error('You are trying to render without setting data (xDomain).');\n\n                if(!this.xScale) {\n                    this.xScaleGenerator = _.nw.xScaleFactory(this.dataSrc, this.options);\n                    this.xScale = this.xScaleGenerator.scale(this.xDomain);\n                    this.rangeBand = this.xScaleGenerator.rangeBand();\n                } else {\n                    this.xScaleGenerator.update(this.xDomain, this.dataSrc);\n                    this.rangeBand = this.xScaleGenerator.rangeBand();\n                }\n            },\n\n            computeYScale: function () {\n                if (!this.yDomain) throw new Error('You are trying to render without setting data (yDomain).');\n\n                var yScaleDomain = this._getYScaledDomain(this.yDomain, this.options);\n\n                if(!this.yScale) {\n                    this.yScaleGenerator = _.nw.yScaleFactory(this.dataSrc, this.options, this.options.yAxis.type, this.yDomain);\n                    this.yScale = this.yScaleGenerator.scale(yScaleDomain);\n                } else {\n                    this.yScaleGenerator.update(yScaleDomain, this.dataSrc);\n                }\n            },\n\n            /**\n            * Provides a scaling function based on the xAxis values.\n            *\n            * ###Example:\n            *\n            *     var scaledValue = this.xScale(100);\n            *\n            * @function xScale\n            * @param {Number|String} value The value to be scaled.\n            * @return {Number} The scaled value according to the current xAxis settings.\n            */\n            xScale: undefined,\n\n            /**\n            * Provides a scaling function based on the yAxis values.\n            *\n            * ###Example:\n            *\n            *     var scaledValue = this.yScale(100);\n            *\n            * @function yScale\n            * @param {Number} value The value to be scaled.\n            * @return {Number} The scaled value according to the current yAxis settings.\n            */\n            yScale: undefined,\n\n            /**\n            * Modifies the domain for the yAxis.\n            *\n            * ###Example:\n            *\n            *     this.setYDomain([100, 200]);\n            *\n            * @function setYDomain\n            * @param {Array} domain The domain array representing the min and max values visible on the yAxis.       */\n            setYDomain: function (domain) {\n                this.yScaleGenerator.setDomain(domain);\n            },\n\n            /**\n            * Redraws the yAxis with the new settings and domain.\n            *\n            * ###Example:\n            *\n            *     this.redrawYAxis();\n            *\n            * @function redrawYAxis\n            */\n            redrawYAxis: function () {\n                this.svg.select('.y.axis').call(this.yAxis());\n                this.renderGridlines();\n            },\n\n            _animationDuration: function () {\n                var opt = this.options.chart.animations;\n                return opt && opt.enable ?\n                    opt.duration != null ? opt.duration : 400 :\n                    0;\n            },\n\n            computeScales: function () {\n                this.computeXScale();\n                this.computeYScale();\n\n                return this;\n            },\n\n            _xAxis: undefined,\n            xAxis: function () {\n                if (!this._xAxis) {\n                    this._xAxis = this.xScaleGenerator.axis().orient(this.options.xAxis.orient);\n                }\n                return this._xAxis;\n            },\n\n            _yAxis: undefined,\n            yAxis: function () {\n                if(!this._yAxis) {\n                    this._yAxis = this.yScaleGenerator.axis().orient(this.options.yAxis.orient);\n                }\n                return this._yAxis;\n            },\n\n            renderXAxis: function () {\n                var xAxis = this.xAxis();\n                var y = this.options.chart.plotHeight + this.options.chart.padding.top;\n                var x = this.options.chart.internalPadding.left;\n\n                this._xAxisGroup = this.svg.selectAll('.x.axis')\n                    .data([1]);\n\n                if (!this._xAxisGroup.node()) {\n                    this._xAxisGroup.enter()\n                        .append('g')\n                        .attr('transform', 'translate(' + x + ',' + y + ')')\n                        .attr('class', 'x axis');\n                } else {\n                    d3.select(this._xAxisGroup.node())\n                        .attr('transform', 'translate(' + x + ',' + y + ')');\n                }\n\n\n                this._xAxisGroup\n                    .transition().duration(this._animationDuration())\n                    .call(xAxis);\n\n                this.xScaleGenerator.postProcessAxis(this._xAxisGroup);\n\n                return this;\n            },\n\n            renderYAxis: function () {\n                var x = this.options.chart.internalPadding.left;\n                var y = this.options.chart.padding.top;\n\n                this._yAxisGroup = this.svg.selectAll('.y.axis')\n                    .data([1]);\n\n                if (!this._yAxisGroup.node()) {\n                    this._yAxisGroup\n                        .enter().append('g')\n                        .attr('transform', 'translate(' + x + ',' + y + ')')\n                        .attr('class', 'y axis');\n                } else {\n                    d3.select(this._yAxisGroup.node())\n                        .attr('transform', 'translate(' + x + ',' + y + ')');\n                }\n\n                this._renderYAxisElement();\n\n                return this;\n            },\n\n            _renderYAxisElement: function () {\n                var options = this.options.yAxis;\n                var alignmentOffset = { bottom: '.8em', middle: '.35em', top: '0' };\n\n                this._yAxisGroup\n                    .transition().duration(this._animationDuration())\n                    .call(this.yAxis())\n                    .selectAll('.tick text')\n                        .attr('dy', alignmentOffset[options.labels.verticalAlign]);\n            },\n\n            renderAxisLabels: function () {\n                var adjustFactor = 40/46.609; // this factor is to account for the difference between the actual svg size and what we get from the DOM\n                var bounds, x, y;\n                var el;\n\n                if (this.options.xAxis.title) {\n                    bounds = _.nw.textBounds(this.options.xAxis.title, '.x.axis-title');\n                    y = this.options.chart.internalPadding.bottom;\n                    x = 0;\n                    el = this._xAxisGroup.selectAll('.x.axis-title').data([1]);\n                    if (!el.node()) {\n                        el.enter().append('text')\n                            .attr('class', 'x axis-title');\n                    }\n\n                    d3.select(el.node())\n                        .attr('x', x)\n                        .attr('y', y)\n                        .attr('alignment-baseline', 'after-edge')\n                        .attr('dx', (this.options.chart.plotWidth - bounds.width) / 2)\n                        .text(this.options.xAxis.title);\n                }\n\n                if (this.options.yAxis.title) {\n                    bounds = _.nw.textBounds(this.options.yAxis.title, '.y.axis-title');\n                    y = -this.options.chart.internalPadding.left + bounds.height * adjustFactor;\n                    x = 0;\n                    el = this._yAxisGroup.selectAll('.y.axis-title').data([1]);\n                    if (!el.node()) {\n                        el.enter().append('text')\n                            .attr('class', 'y axis-title');\n                    }\n\n                    d3.select(el.node())\n                        .attr('class', 'y axis-title')\n                        .attr('transform', 'rotate(-90)')\n                        .attr('x', x)\n                        .attr('y', y)\n                        .attr('dx', -(this.options.chart.plotHeight + bounds.width) / 2)\n                        .attr('dy', 0)\n                        .text(this.options.yAxis.title);\n                }\n\n                return this;\n            },\n\n            renderGridlines: function () {\n                var option = this.options.chart.gridlines;\n                var horizontal = option === 'horizontal' || option === 'both';\n                var vertical = option === 'vertical' || option === 'both';\n\n                function getYTicks(axis, smart) {\n                    var tickValues = axis.tickValues();\n\n                    if(!tickValues) {\n                        var numTicks = axis.ticks()[0];\n                        return axis.scale().ticks(numTicks).slice(1);\n                    }\n\n                    if (smart) {\n                        tickValues.pop();\n                    }\n\n                    return tickValues.slice(1);\n                }\n\n                function getXTicks(axis) {\n                    return axis.tickValues() || (axis.scale().ticks ? axis.scale().ticks().slice(1) : axis.scale().domain());\n                }\n\n                var ticks, gr;\n                var x = this.xScale;\n                var y = this.yScale;\n\n                if(horizontal) {\n                    ticks = getYTicks(this.yAxis(), this.options.yAxis.smartAxis);\n                    var w = this.options.chart.plotWidth;\n\n                    // remove previous lines (TODO: we need a better way)\n                    // this._yAxisGroup.select('g.grid-lines').remove();\n                    gr = this._yAxisGroup\n                        .selectAll('.grid-lines')\n                        .data([ticks]);\n\n                    gr.enter().append('svg:g')\n                        .attr('class', 'grid-lines');\n\n                    var lines = gr.selectAll('.grid-line')\n                        .data(function (d) { return d; });\n\n                    lines.transition().duration(this._animationDuration())\n                        .attr('x1', 0)\n                        .attr('x2', function () {\n                            return w;\n                        })\n                        .attr('y1', y)\n                        .attr('y2', y);\n\n                    lines.enter().append('line')\n                            .attr('class', 'grid-line')\n                            .attr('x1', 0)\n                            .attr('x2', function () {\n                                return w;\n                            })\n                            .attr('y1', y)\n                            .attr('y2', y);\n\n                    lines.exit().remove();\n                }\n\n                if(vertical) {\n                    // remove previous lines (TODO: we need a better way)\n                    this._xAxisGroup.select('g.grid-lines').remove();\n                    gr = this._xAxisGroup.append('svg:g').attr('class', 'grid-lines');\n                    ticks = getXTicks(this.xAxis());\n                    var offset = this.rangeBand / 2;\n                    var h = this.options.chart.plotHeight;\n\n                    gr.selectAll('.grid-line')\n                        .data(ticks)\n                        .enter().append('line')\n                            .attr('class', 'grid-line')\n                            .attr('x1', function (d) { return x(d) + offset; })\n                            .attr('x2', function (d) { return x(d) + offset; })\n                            .attr('y1', -h)\n                            .attr('y2', 0);\n                }\n\n                return this;\n            },\n\n            renderBackground: function () {\n                var options = this.options.chart;\n                this.background = this.background || this.createVisualizationLayer('background', 0);\n                var g = this.background.selectAll('.plot-area-background').data([null]);\n\n                g.enter().append('rect')\n                    .attr('class', 'plot-area-background')\n                    .attr('x', options.internalPadding.left)\n                    .attr('y', options.internalPadding.top)\n                    .attr('width', options.plotWidth)\n                    .attr('height', options.plotHeight);\n\n                g.exit().remove();\n\n                return this;\n            },\n\n            render: function () {\n\n                this.composeOptions();\n                this.adjustDomain();\n                this.calcMetrics();\n                this.computeScales();\n                this.baseRender();\n\n                this\n                    .renderBackground()\n                    .renderXAxis()\n                    .renderYAxis()\n                    .renderGridlines()\n                    .renderAxisLabels()\n                    .renderVisualizations();\n\n                return this;\n            },\n\n            datum: function (d, index) {\n                if(_.isObject(d) && _.isArray(d.data))\n                    return _.map(d.data, _.bind(this.datum, this));\n\n                return {\n                    y: _.isObject(d) ? d.y : d,\n                    x: _.isObject(d) ? d.x : this.options.xAxis.categories ? this.options.xAxis.categories[index] : index\n                };\n            },\n\n            adjustDomain: function () {\n                var extents = this.getExtents();\n                this._adjustXDomain(extents);\n                this._adjustYDomain(extents);\n\n                this._yAxis = null;\n                this._xAxis = null;\n                this.yScale = null;\n            },\n\n            _adjustXDomain: function (extents) {\n                this.xDomain = this.getXDomain();\n                var dataVis = _.filter(this._visualizations, function (v) { return _.nw.isSupportedDataFormat(v.data); });\n                this.dataSrc = _.flatten(\n                    _.map(dataVis, function (v) {\n                        return _.flatten(_.map(v.data, _.bind(this.datum, this)));\n                    }, this)\n                );\n\n                // _.all() on empty array returns true, so we guard against it\n                var isCategoricalData = this.dataSrc.length && _.all(this.dataSrc, function (d) { return +d.x !== d.x; });\n                var dataSrcCategories = _.uniq(_.pluck(this.dataSrc, 'x'));\n                var sameCats = this.options.xAxis.categories ?\n                    this.options.xAxis.categories.length === dataSrcCategories.length && _.intersection(this.options.xAxis.categories, dataSrcCategories).length === dataSrcCategories.length :\n                    false;\n\n                if (isCategoricalData && !(this.options.xAxis.categories && sameCats)) {\n                    this.options.xAxis.categories = dataSrcCategories;\n                }\n            },\n\n            _adjustYDomain: function (extents) {\n                this.yDomain = extents.length ? extents : [0, 10];\n                this.yMin = this.yDomain[0];\n                this.yMax = this.yDomain[this.yDomain.length - 1];\n            },\n\n            getExtents: function (axis) {\n                var field = axis && axis === 'x' ? 'xExtent' : 'yExtent';\n                var dataVis = _.filter(this._visualizations, function (v) { return _.nw.isSupportedDataFormat(v.data); });\n                var all = _.flatten(_.pluck(dataVis, field));\n                return all.length ? d3.extent(all) : [];\n            },\n\n            getXDomain: function () {\n                var dataVis = _.filter(this._visualizations, function (v) { return _.nw.isSupportedDataFormat(v.data); });\n                var all = _.nw.uniq(_.flatten(_.pluck(dataVis, 'xDomain')));\n\n                return all;\n            }\n\n        };\n    };\n\n    Contour.expose('cartesian', cartesian);\n\n})();\n","(function () {\n\n    var root = this;\n\n    var defaultParams = {\n        type: 'image/png', // the mime type of the image; see http://en.wikipedia.org/wiki/Comparison_of_web_browsers#Image_format_support for browser support\n        fileName: 'contour.png', // the fileName for the `download()`\n        target: undefined, // a selector for the container in which to `place()` the image; for example '#image'\n        backgroundColor: '#fff', // the fill color of the image, or `null` for transparent background\n        width: undefined, // the width of the exported image; if `height` is falsy then the height will be scaled proportionally\n        height: undefined // the height of the exported image; if `width` is falsy then the width will be scaled proportionally\n    };\n\n    // browser capabilities\n    var browser = {\n        checked: false // true after browser capabilities have been checked\n    };\n\n    // queue of operations to perform synchronously\n    var queue = [];\n    // true if working on something\n    var working = false;\n\n\n    /**\n    * Saves a visualization as an image.\n    * You can either trigger a download of the image or place the image within a container.\n    *\n    * ###Example:\n    *\n    *     var chart = new Contour(...)\n    *         ...\n    *         .exportable()\n    *         .render();\n    *\n    *     document.getElementById('save').onclick = function () {\n    *         chart.download({\n    *             fileName: 'myContourChart.png'\n    *         });\n    *\n    * ###External dependencies:\n    *\n    * IE9-11 and Safari won't safely export a canvas to which an SVG has been\n    * rendered. To get around this limitation in those browsers, we use CanVG\n    * (\"canned veggies\"), an implementation of SVG written in JavaScript to\n    * render the SVG directly to the canvas. During initialization of the\n    * 'exportable' plugin, CanVG is automatically downloaded from\n    * http://canvg.googlecode.com/svn/trunk/ if the browser fails the test\n    * SVG export.\n    *\n    * @name exportable\n    */\n    var exportable = function () {\n        // CSS properties to ignore for diff\n        var cssIgnoreDiff = {\n            cssText: 1,\n            parentRule: 1\n        };\n        // CSS properties shared between HTML and SVG\n        var cssSharedSvg = {\n            font: 1,\n            fontFamily: 1,\n            fontSize: 1,\n            fontSizeAdjust: 1,\n            fontStretch: 1,\n            fontStyle: 1,\n            fontVariant: 1,\n            fontWeight: 1,\n            direction: 1,\n            letterSpacing: 1,\n            textDecoration: 1,\n            unicodeBidi: 1,\n            wordSpacing: 1,\n            clip: 1,\n            cursor: 1,\n            display: 1,\n            overflow: 1,\n            visibility: 1,\n            opacity: 1\n        };\n\n\n        // interface\n\n        return {\n            init: function () {\n                // check browser capabilities and set up necessary shims\n                // only do this once per page load\n                if (!browser.checked) {\n                    addToQueue(checkBrowser);\n                }\n\n                return this;\n            },\n\n            /**\n            * Saves a visualization as an image, triggering a download.\n            *\n            * ###Browser variations:\n            *\n            * - Chrome saves the image.\n            * - Firefox and IE10-11 display a prompt, then save the image.\n            * - IE9 and Safari open the image in a new tab, enabling the user to manually save the image.\n            *\n            * ###Example:\n            *\n            *     var chart = new Contour(...)\n            *         ...\n            *         .exportable()\n            *         .render();\n            *\n            *     document.getElementById('save').onclick = function () {\n            *         chart.download({\n            *             fileName: 'contour.png',\n            *             width: 640\n            *         });\n            *\n            * @name download\n            * @param {object} options Configuration options specific to downloading the image.\n            * @param {string} options.type Specifies the mime type of the image. See http://en.wikipedia.org/wiki/Comparison_of_web_browsers#Image_format_support for browser support. Default: 'image/png'.\n            * @param {string} options.fileName Specifies the file name for the download. Default: 'contour.png'.\n            * @param {string} options.backgroundColor Specifies the fill color of the image. Use `null` for transparent background. Default: '#fff'.\n            * @param {int} options.width Specifies the width of the exported image. If `height` is falsy then the height is scaled proportionally. Default: `undefined`, which means don't do any scaling.\n            * @param {int} options.height Specifies the height of the exported image. If `width` is falsy then the width is scaled proportionally. Default: `undefined`, which means don't do any scaling.\n            */\n            download: function (options) {\n                var container = this.container;\n\n                addToQueue(function () {\n                    exportImage(container, options, 'download');\n                });\n\n                return this;\n            },\n\n            /**\n            * Saves a visualization as an image, placing it within a container.\n            *\n            * ###Example:\n            *\n            *     var chart = new Contour(...)\n            *         ...\n            *         .exportable()\n            *         .render();\n            *     document.getElementById('save').onclick = function () {\n            *         chart.place({\n            *             target: '#image'\n            *         });\n            *\n            * @name place\n            * @param {object} options Configuration options specific to placing the image in a container.\n            * @param {string} options.type Specifies the mime type of the image. See http://en.wikipedia.org/wiki/Comparison_of_web_browsers#Image_format_support for browser support. Default: 'image/png'.\n            * @param {string} options.target Specifies a selector for the container. For example: '#image' will append the image into `<div id=\"image\"></div>`.\n            * @param {string} options.backgroundColor Specifies the fill color of the image. Use `null` for transparent background. Default: '#fff'.\n            * @param {int} options.width Specifies the width of the exported image. If `height` is falsy then the height is scaled proportionally. Default: `undefined`, which means don't do any scaling.\n            * @param {int} options.height specifies the height of the exported image. If `width` is falsy then the width is scaled proportionally. Default: `undefined`, which means don't do any scaling.\n            */\n            place: function (options) {\n                var container = this.container;\n\n                addToQueue(function () {\n                    exportImage(container, options, 'place');\n                });\n\n                return this;\n            }\n        };\n\n\n        // SVG to canvas export function\n        // adapted from https://github.com/sampumon/SVG.toDataURL\n        // which based on http://svgopen.org/2010/papers/62-From_SVG_to_Canvas_and_Back/#svg_to_canvas\n        function getSvgDataUrl(svg, options, dataUrlCreated) {\n            switch (options.type) {\n                case 'image/svg+xml':\n                    return makeSvgUrl();\n\n                default: // 'image/png' or 'image/jpeg'\n                    return makeImageUrl();\n            }\n\n\n            function encodeBase64DataUrl(svgXml) {\n                // https://developer.mozilla.org/en/DOM/window.btoa\n                return 'data:image/svg+xml;base64,' + btoa(svgXml);\n            }\n\n            // convert base64/URLEncoded data component to raw binary data held in a string\n            function dataUrlToBlob(dataUrl) {\n                /*jshint nonstandard:true*/\n                var byteString;\n                if (dataUrl.split(',')[0].indexOf('base64') >= 0) {\n                    byteString = atob(dataUrl.split(',')[1]);\n                } else {\n                    byteString = unescape(dataUrl.split(',')[1]);\n                }\n\n                // separate out the mime component\n                var mimeString = dataUrl.split(',')[0].split(':')[1].split(';')[0];\n\n                // write the bytes of the string to a typed array\n                var byteArray = new Uint8Array(byteString.length);\n                for (var i = 0; i < byteString.length; i++) {\n                    byteArray[i] = byteString.charCodeAt(i);\n                }\n\n                return new Blob([byteArray], {\n                    type: mimeString\n                });\n            }\n\n            function makeSvgUrl() {\n                var svgXml = (new XMLSerializer()).serializeToString(svg);\n                var svgDataUrl = encodeBase64DataUrl(svgXml);\n\n                dataUrlCreated(svgDataUrl, null, function () {});\n            }\n\n            function makeImageUrl() {\n                var canvas = document.createElement('canvas');\n                var context = canvas.getContext('2d');\n\n                var svgXml = (new XMLSerializer()).serializeToString(svg);\n\n                if (root.canvg) {\n                    // use Canvg renderer for image export\n                    renderImageCanvg();\n                } else {\n                    // use native renderer for image export (this might fail)\n                    renderImageNative();\n                }\n\n                function imageRendered() {\n                    var imageDataUrl = canvas.toDataURL(options.type);\n\n                    if (browser.createsObjectUrls) {\n                        var imageBlob = dataUrlToBlob(imageDataUrl);\n\n                        var domUrl = root.URL || root.webkitURL;\n                        var objectUrl = domUrl.createObjectURL(imageBlob);\n\n                        dataUrlCreated(objectUrl, imageBlob, function () {\n                            domUrl.revokeObjectURL(objectUrl);\n                        });\n                    } else {\n                        dataUrlCreated(imageDataUrl, null, function () {});\n                    }\n                }\n\n                function renderImageNative() {\n                    var svgImg = new Image();\n                    svgImg.src = encodeBase64DataUrl(svgXml);\n\n                    svgImg.onload = function () {\n                        canvas.width = svgImg.width;\n                        canvas.height = svgImg.height;\n\n                        if (options.backgroundColor) {\n                            context.fillStyle = options.backgroundColor;\n                            context.fillRect(0, 0, svgImg.width, svgImg.height);\n                        }\n\n                        context.drawImage(svgImg, 0, 0);\n\n                        imageRendered();\n                    };\n\n                    svgImg.onerror = function () {\n                        throw new Error('Cannot export image');\n                    };\n                }\n\n                function renderImageCanvg() {\n                    // note that Canvg gets the SVG element dimensions incorrectly if not specified as attributes\n                    // also this Canvg call is synchronous and blocks\n                    canvg(canvas, svgXml, {\n                        ignoreMouse: true,\n                        ignoreAnimation: true,\n                        offsetX: undefined,\n                        offsetY: undefined,\n                        scaleWidth: undefined,\n                        scaleHeight: undefined,\n                        renderCallback: imageRendered\n                    });\n                }\n            }\n        }\n\n\n        // clone SVG in isolation with styles directly applied\n        function createSvgClone(svgNode, svgCloned) {\n            createIsolatedNode(function (nodeClone, destroyIsolatedNode) {\n                // clone nodes and apply styles directly to each node\n                cloneNodes(svgNode, nodeClone);\n\n                // clone legend DIV as SVG\n                cloneLegendDiv(svgNode, nodeClone);\n\n                svgCloned(d3.select(nodeClone).select('svg').node(), destroyIsolatedNode);\n            });\n\n\n            // compare computed styles at this node and apply the differences directly\n            function applyStyles(sourceNode, targetNode) {\n                var sourceStyle = root.getComputedStyle(sourceNode);\n                var targetStyle = root.getComputedStyle(targetNode);\n\n                for (var prop in sourceStyle) {\n                    if (!cssIgnoreDiff[prop] && !isFinite(prop)) {\n                        // note that checking for sourceStyle.hasOwnProperty(prop) eliminates all valid style properties in Firefox\n                        if (targetStyle[prop] !== sourceStyle[prop]) {\n                            targetNode.style[prop] = sourceStyle[prop];\n                        }\n                    }\n                }\n            }\n\n            // clone nodes and apply styles directly to each node\n            function cloneNodes(sourceNode, targetNode) {\n                var newNode = sourceNode.cloneNode(false);\n                targetNode.appendChild(newNode);\n\n                if (!sourceNode.tagName) return; // skip inner text\n\n                // compare computed styles at this node and apply the differences directly\n                applyStyles(sourceNode, newNode);\n\n                _.each(sourceNode.childNodes, function (childNode) {\n                    // clone each child node and apply styles\n                    cloneNodes(childNode, newNode);\n                });\n            }\n\n            function createIsolatedNode(nodeLoaded) {\n                var iframe = document.body.appendChild(document.createElement('iframe'));\n                iframe.style.visibility = 'hidden';\n                var iframeWindow = iframe.contentWindow;\n                var iframeDocument = iframeWindow.document;\n\n                iframe.onload = function () {\n                    var nodeClone = iframeDocument.createElement('div');\n                    iframeDocument.body.appendChild(nodeClone);\n\n                    var destroyIframe = function () {\n                        // destroy clone\n                        iframeDocument.body.removeChild(nodeClone);\n                        document.body.removeChild(iframe);\n                    };\n\n                    nodeLoaded(nodeClone, destroyIframe);\n                };\n\n                iframeDocument.open();\n                iframeDocument.write('<!DOCTYPE html>');\n                iframeDocument.write('<html><head></head><body></body></html>');\n                iframeDocument.close();\n            }\n\n            function applyDivStylesToSvg(sourceNode, target) {\n                var targetNode = target.node();\n                var sourceStyle = root.getComputedStyle(sourceNode);\n                var targetStyle = root.getComputedStyle(targetNode);\n\n                for (var prop in sourceStyle) {\n                    if (cssSharedSvg[prop]) {\n                        // note that checking for sourceStyle.hasOwnProperty(prop) eliminates all valid style properties in Firefox\n                        if (targetStyle[prop] !== sourceStyle[prop]) {\n                            targetNode.style[prop] = sourceStyle[prop];\n                        }\n                    }\n                }\n\n                // translate DIV styles to SVG attributes and styles\n                switch (targetNode.nodeName) {\n                case 'rect':\n                    target.attr({\n                        'rx': sourceStyle.borderTopLeftRadius,\n                        'ry': sourceStyle.borderTopLeftRadius\n                    });\n                    target.style({\n                        'fill': sourceStyle.backgroundColor,\n                        'stroke': sourceStyle.borderLeftColor,\n                        'stroke-width': sourceStyle.borderLeftWidth\n                    });\n                    break;\n                case 'text':\n                    target.style({\n                        'fill': sourceStyle.color\n                    });\n                    break;\n                }\n            }\n\n            function cloneLegendDiv(sourceNode, targetNode) {\n                var containerDiv = d3.select(sourceNode.parentNode).select('div.contour-legend');\n                if (containerDiv.empty()) return;\n\n                var containerDivNode = containerDiv.node();\n\n                var containerSvg = d3.select(targetNode).select('svg').append('g')\n                    .attr('transform', 'translate(' + (containerDivNode.offsetLeft + containerDivNode.clientLeft) +\n                        ',' + (containerDivNode.offsetTop + containerDivNode.clientTop) + ')');\n                applyDivStylesToSvg(containerDivNode, containerSvg);\n\n                var rect = containerSvg.append('rect')\n                    .attr('width', containerDivNode.clientWidth)\n                    .attr('height', containerDivNode.clientHeight);\n                applyDivStylesToSvg(containerDivNode, rect);\n\n                var entriesDivs = containerDiv.selectAll('.contour-legend-entry');\n\n                _.each(entriesDivs[0], function (entryDivNode) {\n                    var entryDiv = d3.select(entryDivNode);\n\n                    var enter = containerSvg.append('g');\n                    applyDivStylesToSvg(entryDivNode, enter);\n\n                    var entryDivKeyNode = getEntryDivSubNode('.contour-legend-key');\n                    var swatch = enter.append('rect')\n                        .attr('x', entryDivKeyNode.offsetLeft)\n                        .attr('y', entryDivKeyNode.offsetTop)\n                        .attr('width', entryDivKeyNode.offsetWidth - 2)\n                        .attr('height', entryDivKeyNode.offsetHeight - 2);\n                    applyDivStylesToSvg(entryDivKeyNode, swatch);\n\n                    var entryDivSeriesNode = getEntryDivSubNode('.series-name');\n                    var text = enter.append('text')\n                        .attr('x', entryDivSeriesNode.offsetLeft + 1)\n                        .attr('y', entryDivSeriesNode.offsetTop + entryDivSeriesNode.offsetHeight - entryDivSeriesNode.offsetParent.clientTop - 2)\n                        .text(entryDivSeriesNode.textContent);\n                    applyDivStylesToSvg(entryDivSeriesNode, text);\n\n                    function getEntryDivSubNode(selector) {\n                        return entryDiv.select(selector).node();\n                    }\n                });\n            }\n        }\n\n\n        function getProportionedBounds(original, specified) {\n            if (specified.width && specified.height) {\n                return specified;\n            } else if (specified.width) {\n                return {\n                    width: specified.width,\n                    height: specified.width * original.height / original.width\n                };\n            } else if (specified.height) {\n                return {\n                    width: specified.height * original.width / original.height,\n                    height: specified.height\n                };\n            } else {\n                return original;\n            }\n        }\n\n\n        function exportImage(container, options, exporter) {\n            startWork();\n\n            // merge configuration options with defaults\n            options = options || {};\n            _.defaults(options, defaultParams);\n\n            var svgNode = container.select('svg').node();\n            // get bounds from original SVG, and proportion them based on specified options\n            var bounds = svgNode.getBoundingClientRect();\n            var boundsClone = getProportionedBounds(bounds, options);\n\n            // clone SVG in isolation with styles directly applied\n            createSvgClone(svgNode, performExport);\n\n            function performExport(svgNodeClone, destroySvgClone) {\n                svgNodeClone.setAttribute('width', boundsClone.width);\n                svgNodeClone.setAttribute('height', boundsClone.height);\n\n                // Safari can only open a new tab with the image\n                // the tab must be opened before `getSvgDataUrl()` to avoid getting blocked due to asynchronous callbacks\n                var win;\n                if (exporter === 'download' && !(browser.aDownloads || browser.savesMsBlobs)) {\n                    win = root.open();\n                }\n\n                getSvgDataUrl(svgNodeClone, options, function (url, blob, revokeUrl) {\n                    destroySvgClone();\n\n                    // exporter functions\n                    var exporters = {\n                        'download': function () {\n                            if (browser.aDownloads) {\n                                // make a link to download and click it\n                                var a = document.createElement('a');\n                                a.download = options.fileName;\n                                a.href = url;\n                                document.body.appendChild(a);\n                                a.click();\n                                document.body.removeChild(a);\n                            } else if (browser.savesMsBlobs && blob) {\n                                // IE10-11 support a method to save/open a blob\n                                navigator.msSaveOrOpenBlob(blob, options.fileName);\n                            } else {\n                                // Safari and IE9 can only open a new tab with the image\n                                if (!win) {\n                                    // in case `blob` was falsy or the `open()` above returned undefined, `win` will be undefined, so attempt here (and this might return undefined as well)\n                                    win = root.open();\n                                }\n                                if (win) {\n                                    if (browser.createsObjectUrls) {\n                                        // Safari can set the url of the newly-opened tab to the object URL of the blob\n                                        win.location = url;\n                                    } else {\n                                        // for IE9, create a document with the image\n                                        var doc = win.document;\n                                        doc.write('<!DOCTYPE html>');\n                                        doc.write('<html><head></head><body>');\n                                        doc.write('<img src=\"' + url + '\">');\n                                        doc.write('</body></html>');\n                                    }\n                                }\n                            }\n                            // wait for download to start\n                            setTimeout(function () {\n                                revokeUrl();\n                                finishWork();\n                            }, 1);\n                        },\n                        'place': function () {\n                            var img = document.createElement('img');\n                            img.onload = function () {\n                                revokeUrl();\n                                finishWork();\n                            };\n                            img.src = url;\n                            d3.select(options.target).node().appendChild(img);\n                        }\n                    };\n                    // call exporter function\n                    exporters[exporter]();\n                });\n            }\n        }\n    };\n\n\n    // queue functions\n\n    // queue will wait until any asynchronous tasks are complete prior to calling the next fn()\n    function addToQueue(fn) {\n        if (working) {\n            queue.push(fn);\n        } else {\n            fn();\n        }\n    }\n\n    // call before starting an asynchronous task\n    function startWork() {\n        working = true;\n    }\n\n    // call after finishing an asynchronous task\n    function finishWork() {\n        working = false;\n\n        var fn = queue.shift();\n        if (fn) {\n            fn();\n        }\n    }\n\n\n    // check browser capabilities and set up necessary shims\n    function checkBrowser() {\n        startWork();\n        browser.checked = true;\n\n        checkEncodesBase64();\n        checkADownloads();\n        checkSavesMsBlobs();\n        checkCreatesObjectUrls();\n        checkExportsSvg(finishWork);\n\n\n        function checkEncodesBase64() {\n            browser.encodesBase64 = !!root.btoa;\n\n            // setup shim for IE9\n            if (!browser.encodesBase64) {\n                setupBase64Shim();\n            }\n        }\n\n        function checkADownloads() {\n            browser.aDownloads = document.createElement('a').download !== undefined;\n        }\n\n        function checkSavesMsBlobs() {\n            browser.savesMsBlobs = !!navigator.msSaveOrOpenBlob;\n        }\n\n        function checkCreatesObjectUrls() {\n            var domUrl = root.URL || root.webkitURL;\n            browser.createsObjectUrls = domUrl && domUrl.createObjectURL;\n        }\n\n        function checkExportsSvg() {\n            startWork();\n\n            browser.exportsSvg = false;\n\n            var iframe = document.body.appendChild(document.createElement('iframe'));\n            iframe.style.visibility = 'hidden';\n            var doc = iframe.contentWindow.document;\n\n            iframe.onload = function () {\n                try {\n                    var svg = doc.querySelector('svg');\n                    var img = doc.querySelector('img');\n                    var canvas = doc.querySelector('canvas');\n                    var context = canvas.getContext('2d');\n                    canvas.width = img.getAttribute('width') * 1;\n                    canvas.height = img.getAttribute('height') * 1;\n                    var sourceImg = new Image();\n                    sourceImg.width = canvas.width;\n                    sourceImg.height = canvas.height;\n                    sourceImg.onload = function () {\n                        try {\n                            context.drawImage(sourceImg, 0, 0, img.width, img.height);\n                            img.src = canvas.toDataURL();\n\n                            browser.exportsSvg = true; // yay\n                        } catch (e) {}\n\n                        svgExportChecked();\n                    };\n                    var xml = (new XMLSerializer()).serializeToString(svg);\n                    sourceImg.src = 'data:image/svg+xml,' + encodeURIComponent(xml);\n                } catch (e) {\n                    svgExportChecked();\n                }\n            };\n\n            doc.open();\n            doc.write('<!DOCTYPE html>');\n            doc.write('<html><head></head><body>');\n            doc.write('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"2\" height=\"2\" viewBox=\"0 0 1 1\"><circle r=\"1\" fill=\"red\"/></svg>');\n            doc.write('<img width=\"2\" height=\"2\">');\n            doc.write('<canvas></canvas>');\n            doc.write('</body></html>');\n            doc.close();\n\n\n            function svgExportChecked() {\n                document.body.removeChild(iframe);\n\n                // load Canvg SVG renderer for browsers that can't safely export SVG\n                if (browser.exportsSvg) {\n                    finishWork();\n                } else {\n                    setupCanvgShim(finishWork);\n                }\n            }\n        }\n\n        // base64 shim, for IE9\n        function setupBase64Shim() {\n            var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\n            function InvalidCharacterError(message) {\n                this.message = message;\n            }\n            InvalidCharacterError.prototype = new Error();\n            InvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n            // base64 encoder\n            // from https://gist.github.com/999166\n            root.btoa = function (input) {\n                var str = String(input);\n                for (\n                    // initialize result and counter\n                    var block, charCode, idx = 0, map = chars, output = '';\n                    // if the next str index does not exist:\n                    //   change the mapping table to \"=\"\n                    //   check if d has no fractional digits\n                    str.charAt(idx | 0) || (map = '=', idx % 1);\n                    // \"8 - idx % 1 * 8\" generates the sequence 2, 4, 6, 8\n                    output += map.charAt(63 & block >> 8 - idx % 1 * 8)\n                ) {\n                    charCode = str.charCodeAt(idx += 3 / 4);\n                    if (charCode > 0xFF) {\n                        throw new InvalidCharacterError('\"btoa\" failed: The string to be encoded contains characters outside of the Latin1 range.');\n                    }\n                    block = block << 8 | charCode;\n                }\n                return output;\n            };\n        }\n\n        // Canvg shim, for IE9-11 and Safari\n        function setupCanvgShim(done) {\n            var scripts = [\n                'rgbcolor.js',\n                'StackBlur.js',\n                'canvg.js'\n            ];\n            var remaining = scripts.length;\n            _.each(scripts, function (src) {\n                var script = document.createElement('script');\n                script.type = 'text/javascript';\n                script.onload = function () {\n                    remaining--;\n                    if (remaining === 0) done();\n                };\n                script.src = 'http://canvg.googlecode.com/svn/trunk/' + src;\n                document.head.appendChild(script);\n            });\n        }\n    }\n\n\n    Contour.expose('exportable', exportable);\n\n})();\n","Contour.version = '1.0.1';","(function () {\n\n    var helpers = {\n        xScaleFactory: function (data, options) {\n            // if we have dates in the x field of the data points\n            // we need a time scale, otherwise is an oridinal\n            // two ways to shape the data for time scale:\n            //  [{ x: date, y: 1}, {x: date, y: 2}]\n            //  [{ data: [ x: date, y: 1]}, {data: [x: date, y: 100]}]\n            // if we get no data, we return an ordinal scale\n            var isTimeData = options.xAxis.type === 'time' || (_.isArray(data) && data.length > 0 && data[0].data ?\n                data[0].data[0].x && _.isDate(data[0].data[0].x) :\n                _.isArray(data) && data.length > 0 && data[0].x && _.isDate(data[0].x));\n\n\n            if (isTimeData && options.xAxis.type !== 'ordinal') {\n                return new _.nw.axes.TimeScale(data, options);\n            }\n\n            if (!options.xAxis.categories && options.xAxis.type === 'linear') {\n                return new _.nw.axes.LinearScale(data, options);\n            }\n\n            return new _.nw.axes.OrdinalScale(data, options);\n        },\n\n        yScaleFactory: function (data, options, axisType, domain) {\n            var map = {\n                'log': _.nw.axes.LogYAxis,\n                'smart': _.nw.axes.SmartYAxis,\n                'linear': _.nw.axes.YAxis\n            };\n\n            if (!axisType) {\n                axisType = 'linear';\n            }\n\n            if (axisType === 'linear' && options.yAxis.smartAxis) {\n                axisType = 'smart';\n            }\n\n            if (map[axisType]) {\n                return new map[axisType](data, options, domain);\n            }\n\n            // try by namespace\n            if (_.nw.axes[axisType]) {\n                return new _.nw.axes[axisType](data, options, domain);\n            }\n\n            throw new Error('Unknown axis type: \"' + axisType + '\"');\n        }\n\n    };\n\n    _.nw = _.extend({}, _.nw, helpers);\n\n})();\n","(function () {\n\n    function LinearScale(data, options) {\n        this.options = options;\n        this.data = data;\n\n        this.init();\n    }\n\n    LinearScale.prototype = {\n        init: function () {\n            delete this._scale;\n        },\n\n        /*jshint eqnull:true*/\n        scale: function (domain) {\n            this._domain = domain ? this._getAxisDomain(domain) : this._getAxisDomain(this.data);\n            if(!this._scale) {\n                this._scale = d3.scale.linear().domain(this._domain);\n                if(this.options.xAxis.min == null && this.options.xAxis.max == null)\n                    this._scale.nice();\n            } else {\n                this._scale.domain(this._domain);\n            }\n\n            this._setRange();\n\n            return this._scale;\n        },\n\n        axis: function () {\n            var options = this.options.xAxis;\n            var formatLabel = options.labels.formatter || d3.format(options.labels.format || 'g');\n            var axis = d3.svg.axis()\n                .scale(this._scale)\n                .tickSize(options.innerTickSize, options.outerTickSize)\n                .tickPadding(options.tickPadding)\n                .tickFormat(function (d) {\n                    return _.isDate(d) ? d.getDate() : formatLabel(d);\n                });\n\n            var ticks = axis.scale().ticks();\n            var labelsFit = _.nw.doXLabelsFit(ticks, formatLabel, this.options);\n\n            if (options.firstAndLast) {\n                // show only first and last tick\n                axis.tickValues(_.nw.firstAndLast(this._domain));\n            } else if (options.tickValues) {\n                axis.tickValues(options.tickValues);\n            } else if (options.ticks != null) {\n                axis.ticks(options.ticks);\n            } else if (!labelsFit) {\n                var finalTicks = _.nw.getTicksThatFit(ticks, formatLabel, this.options);\n                axis.tickValues(finalTicks);\n                axis.ticks(finalTicks.length);\n\n            }\n\n            return axis;\n        },\n\n        update: function (domain, dataSrc) {\n            this.data = dataSrc;\n            this.scale(domain);\n        },\n\n        rangeBand: function () {\n            return 1;\n        },\n\n        postProcessAxis: function () {\n            return this;\n        },\n\n        _setRange: function () {\n            var rangeSize = !!this.options.chart.rotatedFrame ? this.options.chart.plotHeight : this.options.chart.plotWidth;\n            var range = !!this.options.chart.rotatedFrame ? [rangeSize, 0]  : [0, rangeSize];\n            return this._scale.range(range);\n        },\n\n        _getAxisDomain: function (domain) {\n            /*jshint eqnull: true*/\n            var optMin = this.options.xAxis.min;\n            var optMax = this.options.xAxis.max;\n            var extents = d3.extent(domain);\n\n            if (optMin == null && optMax == null) {\n                return extents;\n            }\n\n            if (optMin == null) {\n                return [Math.min(extents[0], optMax), optMax];\n            }\n\n            if (optMax == null) {\n                return [optMin, Math.max(extents[1], optMin)];\n            }\n\n            // options are invalid, use the extents\n            if (optMin > optMax) {\n                return extents;\n            }\n\n            return [optMin, optMax];\n        }\n    };\n\n    _.nw.addAxis('LinearScale', LinearScale );\n\n})();\n","(function () {\n\n    var LogYAxis = function (data, options) {\n        this.data = data;\n        this.options = options;\n    };\n\n    function setRange(scale, options) {\n        var rangeSize = options.chart.rotatedFrame ? options.chart.plotWidth : options.chart.plotHeight;\n        var range = options.chart.rotatedFrame ? [0, rangeSize] : [rangeSize, 0];\n        return scale.range(range);\n    }\n\n    var __super = _.nw.axes.YAxis.prototype;\n    LogYAxis.prototype = _.extend({}, __super, {\n        axis: function () {\n            var options = this.options.yAxis;\n            var domain = this._scale.domain();\n            var ticksHint = Math.ceil(Math.log(domain[1]) / Math.log(10));\n            var format = options.labels.formatter || d3.format(options.labels.format || ',.0f');\n\n            var axis = d3.svg.axis()\n                .scale(this._scale)\n                .tickSize(options.innerTickSize, options.outerTickSize)\n                .tickPadding(options.tickPadding);\n            if(options.labels.formatter) {\n                axis.tickFormat(options.labels.formatter);\n            } else {\n                axis.ticks(options.ticks || ticksHint, format);\n            }\n\n\n            return axis;\n        },\n\n        scale: function (domain) {\n            if(!this._scale) {\n                if(domain[0] <= 0.1) domain[0] = 0.1; //throw new Error('Log scales don\\'t support 0 or negative values');\n\n                this._scale = d3.scale.log();\n                this.setDomain(domain).clamp(true);\n\n            }\n\n            setRange(this._scale, this.options);\n\n            return this._scale;\n        },\n\n        update: function (domain, dataSrc) {\n            this.data = dataSrc;\n            if(domain[0] <= 0.1) domain[0] = 0.1; //throw new Error('Log scales don\\'t support 0 or negative values');\n            this.setDomain(domain).clamp(true);\n            this.scale();\n        },\n    });\n\n    _.nw.addAxis('LogYAxis', LogYAxis );\n\n})();\n","(function () {\n\n    // implements the following interface\n    /*\n    {\n        scale: returns the d3 scale for the type\n\n        axis: returns the d3 axis\n\n        range: returns the d3 range for the type\n\n        postProcessAxis:\n    }\n    */\n\n    function OrdinalScale(data, options) {\n        this.options = options;\n        this.data = data;\n\n        this.init();\n    }\n\n    OrdinalScale.prototype = {\n        init: function () {\n            this.isCategorized = true;\n            delete this._scale;\n        },\n\n        scale: function (domain) {\n            if(!this._scale) {\n                this._scale = new d3.scale.ordinal();\n            }\n\n            this.setDomain(domain || this.data);\n\n            return this._scale;\n        },\n\n        /* jshint eqnull:true */\n        axis: function () {\n            var options = this.options.xAxis;\n            var optFormat = (options.labels.format ? d3.format(options.labels.format) : 0);\n            var formatLabel = options.labels.formatter || d3.format(options.labels.format || 'g');\n\n            var tickFormat = options.labels.formatter || (!this.isCategorized ? optFormat : 0) || function (d) { return _.isDate(d) ? d.getDate() : d; };\n            var axis = d3.svg.axis()\n                .scale(this._scale)\n                .innerTickSize(options.innerTickSize)\n                .outerTickSize(options.outerTickSize)\n                .tickPadding(options.tickPadding)\n                .tickFormat(tickFormat);\n\n            var ticks = this.isCategorized && options.categories ? options.categories : _.range(this._domain.length) || [];\n            var labelsFit = _.nw.doXLabelsFit(ticks, formatLabel, this.options);\n\n            if (options.firstAndLast) {\n                // show only first and last tick\n                axis.tickValues(_.nw.firstAndLast(this._domain));\n            } else if (options.maxTicks) {\n                axis.tickValues(_.nw.maxTickValues(options.maxTicks, this._domain));\n            } else if (options.tickValues) {\n                axis.tickValues(options.tickValues);\n            } else if (options.ticks != null) {\n                axis.ticks(options.ticks);\n                if (options.ticks === 0) {\n                    axis.tickValues([]);\n                }\n            } else if (!labelsFit) {\n                var finalTicks = _.nw.getTicksThatFit(ticks, formatLabel, this.options);\n                axis.tickValues(finalTicks);\n                axis.ticks(finalTicks.length);\n            } else {\n                axis.tickValues(options.categories);\n            }\n\n            return axis;\n        },\n\n        /* jshint eqnull:true */\n        postProcessAxis: function (axisGroup) {\n            var options = this.options.xAxis;\n            if (!options.labels || options.labels.rotation == null) return;\n\n            var deg = options.labels.rotation;\n            var rad = _.nw.degToRad(deg);\n            var sign = deg > 0 ? 1 : deg < 0 ? -1 : 0;\n            var pos = deg < 0 ? -1 : 1;\n            var lineHeight = 0.71;\n            var lineCenter = lineHeight / 2; // center of text line is at .31em\n            var cos = Math.cos(rad);\n            var sin = Math.sin(rad);\n            var anchor = options.labels.rotation < 0 ? 'end' : options.labels.rotation > 0 ? 'start' : 'middle';\n\n            axisGroup.selectAll('.tick text')\n                .style({'text-anchor': anchor})\n                .attr('transform', function (d, i, j) {\n                    var x = d3.select(this).attr('x') || 0;\n                    var y = d3.select(this).attr('y') || 0;\n                    return 'rotate(' + options.labels.rotation + ' ' + x + ',' + y + ')';\n                })\n                .attr('dy', function (d, i, j) {\n                    var ref = deg === 0 ? lineHeight : lineCenter;\n                    var num = ((cos * ref) + (sin * ref * pos));\n                    return (num).toFixed(4) + 'em';\n                    // return (sign * ((cos * lineCenter) + (sin * lineCenter))).toFixed(4) + 'em';\n                })\n                .attr('dx', function (d, i, j) {\n                    // var num = ((sin * lineCenter * pos));\n                    // return -num.toFixed(4) + 'em';\n                    return -(sin * lineCenter - 0.31 * sign).toFixed(4) + 'em';\n\n                });\n        },\n\n        update: function (domain, data) {\n            this.data = data;\n            this.scale(domain);\n        },\n\n        setDomain: function (domain) {\n            this._domain = domain;\n            this._scale.domain(domain);\n            this._range();\n        },\n\n        rangeBand: function () {\n            var band = this._scale.rangeBand();\n            if (!band) _.nw.warn('rangeBand is 0, you may have too many points in in the domain for the size of the chart (ie. chartWidth = ' + this.options.chart.plotWidth + 'px and ' + (this._domain.length) + ' X-axis points (plus paddings) means less than 1 pixel per band and there\\'re no half pixels');\n\n            return this._scale.rangeBand();\n        },\n\n        _range: function () {\n            var range = this.options.chart.rotatedFrame ? [this.options.chart.plotHeight, 0] : [0, this.options.chart.plotWidth];\n            var numCats = (this._domain || []).length;\n            var threshold = 30;\n            var rangeType = numCats <= threshold ? 'rangeRoundBands' : 'rangeBands';\n\n            return this.isCategorized ?\n                // this._scale.rangeBands(range, this.options.xAxis.innerRangePadding, this.options.xAxis.outerRangePadding) :\n                this._scale[rangeType](range, this.options.xAxis.innerRangePadding, this.options.xAxis.outerRangePadding) :\n                this._scale.rangePoints(range);\n        }\n    };\n\n    _.nw.addAxis('OrdinalScale', OrdinalScale );\n\n})();\n","(function () {\n\n    var SmartYAxis = function (data, options, domain) {\n        this.data = data;\n        this.options = options;\n        this.yMax = domain[0];\n        this.yMin = domain[1];\n        this.dataMax = d3.max(_.pluck(data, 'y'));\n    };\n\n    /* jshint eqnull: true */\n    function _extractYTickValues(domain, min, max, yMin, yMax, dataMax) {\n        var adjustedDomain = _.uniq(_.nw.merge(_.nw.merge(domain, yMax), dataMax));\n        // we want to be able to remove parameters with default values\n        // so to remove the default yAxis.min: 0, you pass yAxis.min: null\n        // and for that we need to to a truly comparison here (to get null or undefined)\n        if (min == null && max == null)\n            return adjustedDomain;\n\n        if (min == null) {\n            return max > yMin ? _.nw.merge([max], adjustedDomain) : [max];\n        }\n\n        if (max == null) {\n            if (min >= yMax) return [min];\n            adjustedDomain[0] = min;\n\n            return adjustedDomain;\n        }\n\n        return _.nw.merge([min, max], yMax);\n    }\n\n    var __super = _.nw.axes.YAxis.prototype;\n    SmartYAxis.prototype = _.extend({}, __super, {\n        axis: function () {\n            var options = this.options.yAxis;\n            this.domain = this._scale.domain();\n            var tickValues = _extractYTickValues(this.domain, options.min, options.max, this.yMin, this.yMax, this.dataMax);\n            var numTicks = this.numTicks();\n            var axis = __super.axis.call(this);\n            return axis.ticks(numTicks)\n                .tickValues(tickValues);\n        },\n\n        numTicks: function () {\n            return 3;\n        },\n\n        setDomain: function (domain) {\n            var extent = d3.extent(domain);\n            this.yMin = extent[0];\n            this.yMax = extent[1];\n            this._scale.domain(domain);\n\n            this._niceTheScale();\n        },\n\n        _niceTheScale: function () {\n            var perTreshold = 0.05;\n            var domain = this._scale.domain();\n            var min = this.options.yAxis.min || domain[0];\n            var rawMax = this.options.yAxis.max || this.dataMax;\n            var nextTick = _.nw.roundToNextTick(rawMax);\n\n            var max = Math.abs(nextTick - rawMax) < rawMax * perTreshold ? _.nw.roundToNextTick(rawMax + rawMax * perTreshold) : nextTick;\n            // var max = nextTick === rawMax ? _.nw.roundToNextTick(rawMax + Math.pow(10, -_.nw.decDigits(rawMax) - 1)) : nextTick;\n            var nice = [min, max];\n            this._scale.domain(nice);\n        }\n    });\n\n    _.nw.addAxis('SmartYAxis', SmartYAxis );\n})();\n","(function () {\n\n    // implements the following interface\n    /*\n    {\n        scale: returns the d3 scale for the type\n\n        range: returns the d3 range for the type\n    }\n    */\n\n    function dateDiff(d1, d2) {\n        if (!d1 || !d2) return 0;\n        var diff = d1.getTime() - d2.getTime();\n        return diff / (24*60*60*1000);\n    }\n\n\n    function TimeScale(data, options) {\n        this.options = options;\n        this.data = data;\n\n        this.init();\n    }\n\n    TimeScale.prototype = {\n        init: function () {\n            delete this._scale;\n        },\n\n        scale: function (domain) {\n\n            if(!this._scale) {\n                this._scale = new d3.time.scale();\n                this.setDomain(domain);\n            }\n\n            this.range();\n\n            return this._scale;\n        },\n\n\n        /* jshint eqnull:true */\n        axis: function () {\n            var options = this.options.xAxis;\n            var tickFormat = this.getOptimalTickFormat();\n\n            var axis = d3.svg.axis()\n                .scale(this._scale)\n                .tickFormat(tickFormat)\n                .tickSize(options.innerTickSize, options.outerTickSize)\n                .tickPadding(options.tickPadding)\n                .tickValues(this._domain);\n\n            if (this.options.xAxis.tickValues != null) {\n                axis.tickValues(this.options.xAxis.tickValues);\n            } else if (this.options.xAxis.maxTicks != null && this.options.xAxis.maxTicks < this._domain.length) {\n                // override the tickValues with custom array based on number of ticks\n                // we don't use D3 ticks() because you cannot force it to show a specific number of ticks\n                axis.tickValues(_.nw.maxTickValues(options.maxTicks, this._domain));\n\n            } else if (this.options.xAxis.firstAndLast) {\n                // show only first and last tick\n                axis.tickValues(_.nw.firstAndLast(this._domain));\n            }\n\n            return axis;\n        },\n\n        update: function (domain, data) {\n            this.data = data;\n            this.setDomain(domain);\n            this.scale();\n        },\n\n        setDomain: function (domain) {\n            this._domain = domain;\n            var axisDomain = this._getAxisDomain(this._domain);\n            this._scale.domain(axisDomain);\n        },\n\n        postProcessAxis: function (axisGroup) {\n            if (!this.options.xAxis.firstAndLast) return;\n            var labels = axisGroup.selectAll('.tick text')[0];\n            d3.select(labels[0]).style({'text-anchor': 'start'});\n            d3.select(labels[labels.length - 1]).style({'text-anchor': 'end'});\n        },\n\n        rangeBand: function () {\n            return 4;\n        },\n\n        getOptimalTickFormat: function () {\n            if (this.options.xAxis.labels.formatter) return this.options.xAxis.labels.formatter;\n            if (this.options.xAxis.labels.format) return d3.time.format(this.options.xAxis.labels.format);\n\n            var spanDays = Math.abs(dateDiff(this._domain[this._domain.length-1], this._domain[0]));\n            var daysThreshold = this.options.xAxis.maxTicks || 1;\n            if (spanDays < daysThreshold) return d3.time.format('%H:%M');\n            if (spanDays < 365) return d3.time.format('%d %b');\n\n            return d3.time.format('%Y');\n        },\n\n        range: function () {\n            var range = this._getAxisRange(this._domain);\n            return this._scale.rangeRound(range, 0.1);\n        },\n\n\n        _getAxisDomain: function (domain) {\n            if(this.options.xAxis.linearDomain) {\n                return domain;\n            }\n\n            return d3.extent(domain);\n        },\n\n        _getAxisRange: function (domain) {\n            var size = this.options.chart.rotatedFrame ? this.options.chart.plotHeight : this.options.chart.plotWidth;\n\n            if(this.options.xAxis.linearDomain) {\n                return _.range(0, size, size / (domain.length - 1)).concat([size]);\n            }\n\n            return [0, size];\n        }\n    };\n\n    _.nw.addAxis('TimeScale', TimeScale );\n})();\n","(function () {\n\n    var defaults = {\n        chart: {\n            rotatedFrame: true,\n        },\n\n        xAxis: {\n            orient: 'left'\n        },\n\n        yAxis: {\n            orient: 'bottom'\n        }\n    };\n\n    var frame = {\n\n        init: function () {\n            _.merge(this.options, defaults);\n        },\n\n        adjustPadding: function () {\n            var categoryLabels = this.options.xAxis.categories || _.pluck(this.dataSrc, 'x');\n            var text = categoryLabels.join('<br>');\n            var xLabel = _.nw.textBounds(text, '.x.axis');\n            var yLabel = _.nw.textBounds('ABC', '.y.axis');\n            var maxTickSize = function (options) { return Math.max(options.outerTickSize, options.innerTickSize); };\n\n            this.options.chart.internalPadding.left = this.options.chart.padding.left || maxTickSize(this.options.xAxis) + this.options.xAxis.tickPadding + xLabel.width;\n            this.options.chart.internalPadding.bottom = this.options.chart.padding.bottom || maxTickSize(this.options.yAxis) + this.options.yAxis.tickPadding + yLabel.height;\n        },\n\n        adjustTitlePadding: function () {\n            var titleBounds;\n            if (this.options.xAxis.title || this.options.yAxis.title) {\n                if(this.options.xAxis.title) {\n                    titleBounds = _.nw.textBounds(this.options.xAxis.title, '.x.axis-title');\n                    this.options.chart.internalPadding.left += titleBounds.height + this.options.xAxis.titlePadding;\n                }\n\n                if(this.options.yAxis.title) {\n                    titleBounds = _.nw.textBounds(this.options.yAxis.title, '.y.axis-title');\n                    this.options.chart.internalPadding.bottom += titleBounds.height + this.options.yAxis.titlePadding;\n                }\n            }\n        },\n\n        renderYAxis: function () {\n            var yAxis = this.yAxis();\n            var x = this.options.chart.internalPadding.left;\n            var y = this.options.chart.padding.top + this.options.chart.plotHeight;\n\n            this._yAxisGroup = this.svg.selectAll('.y.axis')\n                .data([1]);\n\n            this._yAxisGroup.enter().append('g')\n                .attr('class', 'y axis')\n                .attr('transform', 'translate(' + x+ ',' + y + ')');\n\n            this._yAxisGroup.exit().remove();\n\n            this._yAxisGroup\n                    .transition().duration(this._animationDuration())\n                    .attr('transform', 'translate(' + x+ ',' + y + ')')\n                    .call(yAxis);\n\n            return this;\n        },\n\n        renderXAxis: function () {\n            var x = this.options.chart.internalPadding.left;\n            var y = this.options.chart.padding.top;\n            var xAxis = this.xAxis();\n\n            this._xAxisGroup = this.svg.selectAll('.x.axis')\n                .data([1]);\n\n            this._xAxisGroup.enter().append('g')\n                .attr('class', 'x axis')\n                .attr('transform', 'translate(' + x + ',' + y + ')');\n\n            this._xAxisGroup.exit().remove();\n\n           this._xAxisGroup\n                .transition().duration(this._animationDuration())\n                .attr('transform', 'translate(' + x + ',' + y + ')')\n                .call(xAxis);\n\n            this.xScaleGenerator.postProcessAxis(this._xAxisGroup);\n\n            return this;\n        },\n\n        renderAxisLabels: function () {\n            var lineHeightAdjustment = this.titleOneEm * 0.25; // add 25% of font-size for a complete line-height\n            var adjustFactor = 40/46.609;\n            var el;\n            var bounds, anchor, rotation, tickSize, x, y;\n\n            if (this.options.xAxis.title) {\n                bounds = _.nw.textBounds(this.options.xAxis.title, '.x.axis-title');\n                x = this.options.chart.rotatedFrame ? -bounds.height : this.options.chart.plotWidth;\n                y = this.options.chart.rotatedFrame ? -this.options.chart.internalPadding.left : this.options.chart.internalPadding.bottom - lineHeightAdjustment;\n\n                rotation = this.options.chart.rotatedFrame ? '-90' : '0';\n                el = this._xAxisGroup.selectAll('.x.axis-title').data([null]);\n\n                el.enter().append('text')\n                    .attr('class', 'x axis-title');\n\n                el.attr('x', 0)\n                    .attr('y', y)\n                    .attr('transform', ['rotate(', rotation, ')'].join(''))\n                    .attr('dy', bounds.height * adjustFactor)\n                    .attr('dx', -(this.options.chart.plotHeight + bounds.width) / 2)\n                    .text(this.options.xAxis.title);\n\n                el.exit().remove();\n            }\n\n            if (this.options.yAxis.title) {\n                bounds = _.nw.textBounds(this.options.yAxis.title, '.y.axis-title');\n                tickSize = Math.max(this.options.yAxis.innerTickSize, this.options.yAxis.outerTickSize);\n                anchor = this.options.chart.rotatedFrame ? 'end' : 'middle';\n                x = this.options.chart.rotatedFrame ? this.options.chart.plotWidth : 0;\n                y = this.options.chart.rotatedFrame ?\n                    this.options.chart.internalPadding.bottom:\n                    -this.options.chart.internalPadding.left + this.titleOneEm - lineHeightAdjustment;\n\n                rotation = this.options.chart.rotatedFrame ? '0' : '-90';\n\n                el = this._yAxisGroup.selectAll('.y.axis-title').data([null]);\n\n                el.enter().append('text')\n                    .attr('class', 'y axis-title');\n\n                el.attr('y', y)\n                    .attr('x', x)\n                    .attr('dx', -(this.options.chart.plotWidth + bounds.width) / 2)\n                    .attr('dy', -4) // just because\n                    .attr('transform', ['rotate(', rotation, ')'].join(''))\n                    .text(this.options.yAxis.title);\n\n                el.exit().remove();\n            }\n\n            return this;\n        }\n    };\n\n    /**\n    * Sets the visualization frame so that the xAxis is vertical and the yAxis is horizontal.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * This visualization is a prerequiste for rendering bar charts (`.bar()`).\n    *\n    * ###Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *        .cartesian()\n    *        .horizontal()\n    *        .bar([1, 2, 3, 4, 5, 4, 3, 2, 1])\n    *        .render()\n    *\n    * @function horiztonal\n    */\n\n    Contour.expose('horizontal', frame);\n\n})();\n","(function () {\n\n    var _extent = function (series, field) {\n        var maxs = [], mins = [];\n        _.each(series, function (d) {\n            if(!d.data.length) return;\n            var values = _.pluck(d.data, field);\n            maxs.push(d3.max(values));\n            mins.push(d3.min(values));\n        });\n\n        //\n        if(!mins.length || !maxs.length) return [];\n\n        return [_.min(mins), _.max(maxs)];\n    };\n\n\n    /*jshint eqnull:true */\n    var _stackedExtent = function (data) {\n        var stack = _.nw.stackLayout();\n        var dataSets = stack(data);\n        var ext = [];\n        _.each(dataSets, function (set) {\n            _.each(set.data, function (d, i) {\n                var cur = ext[i] || 0;\n                ext[i] = cur + d.y;\n            });\n        });\n\n        return [_.min(ext), _.max(ext)];\n    };\n\n    var _xExtent = _.partialRight(_extent, 'x');\n    var _yExtent = _.partialRight(_extent, 'y');\n\n    function VisInstanceContainer(data, categories, options, type, renderer, context) {\n        this.type = type;\n        this.renderer = renderer;\n        this.ctx = context;\n        this.categories = categories;\n\n        this.init(data, options);\n    }\n\n    VisInstanceContainer.prototype = {\n\n        init: function (data, options) {\n            // set the options first and then the data\n            this.setOptions(options);\n            this.setData(data);\n        },\n\n        render: function (layer, options) {\n            this.renderer.call(this.ctx, this.data, layer, options);\n\n            return this.ctx;\n        },\n\n        setData: function (data) {\n            var normalizeData = (this.ctx || {}).dataNormalizer || _.nw.normalizeSeries;\n            this.data = normalizeData(data, this.categories);\n            this._updateDomain();\n\n            return this.ctx;\n        },\n\n        setOptions: function (options) {\n            var opt = {};\n            opt[this.type] = options || {};\n            this.options = {};\n            this.options = _.merge({}, (this.renderer || {}).defaults || {}, opt);\n\n            return this.ctx;\n        },\n\n        _updateDomain: function () {\n            if(!this.options[this.type]) throw new Error('Set the options before calling setData or _updateDomain');\n\n            var isSupportedFormat = (this.ctx || {}).isSupportedDataFormat || _.nw.isSupportedDataFormat;\n\n            if (isSupportedFormat(this.data)) {\n                this.xDomain = _.flatten(_.map(this.data, function (set) { return _.pluck(set.data, 'x'); }));\n                this.xExtent = _xExtent(this.data, 'x');\n                this.yExtent = this.options[this.type].stacked ? _stackedExtent(this.data) : _yExtent(this.data);\n            }\n        }\n\n    };\n\n    Contour.VisualizationContainer = VisInstanceContainer;\n\n})();\n","(function () {\n\n    var defaults = {\n        xAxis: {\n            type: 'linear'\n        },\n        area: {\n            stacked: true,\n            areaBase: undefined,\n            preprocess: _.nw.minMaxFilter(1000)\n        }\n    };\n\n    /* jshint eqnull:true */\n    function renderer(data, layer, options) {\n        this.checkDependencies('cartesian');\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var x = _.bind(function (val) { return this.xScale(val) + this.rangeBand / 2 + 0.5; }, this);\n        var y = _.bind(function (val) { return this.yScale(val) + 0.5; }, this);\n        var h = options.chart.plotHeight;\n        var classFn = function (d, i) { return 'series s-' + (i+1) + ' ' + d.name; };\n        var stack = d3.layout.stack().values(function (d) { return d.data; });\n\n        var startArea = d3.svg.area()\n            .x(function(d) { return x(d.x); })\n            .y0(function (d) { return h; })\n            .y1(function(d) { return h; });\n\n        var areaBase = options.area.areaBase != null ? options.area.areaBase : options.yAxis.min;\n        var area = d3.svg.area()\n            .x(function(d) { return x(d.x); })\n            .y0(function (d) { return options.area.stacked ? y(d.y0 || areaBase || 0) : y(0); })\n            .y1(function(d) { return y((options.area.stacked ? d.y0 : 0) + d.y); });\n\n        if(options.area.smooth) {\n            area.interpolate('cardinal');\n            startArea.interpolate('cardinal');\n        }\n\n        renderSeries();\n\n        if (options.tooltip && options.tooltip.enable)\n            renderTooltipTrackers();\n\n        function renderSeries() {\n            data = options.area.preprocess(data);\n\n            var series = layer.selectAll('g.series')\n                    .data(stack(data));\n\n            series.enter()\n                .append('svg:g')\n                .attr('class', classFn)\n                .append('path').datum(function (d) { return d.data; })\n                    .attr('class', 'area')\n                    .attr('d', startArea);\n\n            series.exit().remove();\n\n            if (options.chart.animations && options.chart.animations.enable) {\n                series.select('.area')\n                    .datum(function (d) { return d.data; })\n                    .transition().duration(options.chart.animations.duration || duration)\n                    .attr('d', area);\n            } else {\n                series.select('.area')\n                    .datum(function (d) { return d.data; })\n                    .attr('d', area);\n            }\n        }\n\n        function renderTooltipTrackers() {\n            var trackerSize = 10;\n            // add the tooltip trackers regardless\n            var markers = layer.selectAll('.tooltip-trackers')\n                .data(data, function (d) { return d.name; });\n\n            markers.enter().append('g')\n                .attr('class', 'tooltip-trackers');\n\n            markers.exit().remove();\n\n            var dots = markers.selectAll('.tooltip-tracker')\n                    .data(function (d) {\n                        return d.data;\n                    }, function (d, i) {\n                        return [d.x,d.y,d.y0].join('&');\n                    });\n\n            dots.enter().append('circle')\n                    .attr('class', 'tooltip-tracker')\n                    .attr('opacity', 0)\n                    .attr('r', trackerSize);\n\n            dots.attr('cx', function(d) { return x(d.x); })\n                .attr('cy', function(d) { return y((options.area.stacked ? d.y0 : 0) + d.y); });\n\n            dots.exit().remove();\n\n        }\n    }\n\n    renderer.defaults = defaults;\n\n    /**\n    * Adds an area chart to the Contour instance.\n    *\n    * Area charts are stacked by default when the _data_ includes multiple series.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .area([1,2,3,4])\n    *           .render();\n    *\n    * @name area(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('area', renderer);\n\n})();\n","(function () {\n    /*jshint eqnull:true*/\n    var defaults = {\n        bar: {\n            barClass: null,\n            style: null,\n            stacked: false,\n            groupPadding: 2,      // two px between same group bars\n            barWidth: function() { return this.rangeBand; },\n            offset: function() { return 0; },\n            preprocess: function(data) {\n                return data;\n            }\n        }\n    };\n\n    function barRender(data, layer, options) {\n        this.checkDependencies(['cartesian', 'horizontal']);\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var _this = this;\n        var opt = options.bar;\n        var rectClass = opt.barClass;\n        var style = opt.style;\n        var x = function (d) { return _this.xScale(d) - 0.5; };\n        var y = function (d) { return _this.yScale(d) + 0.5; };\n        var chartOffset = _.nw.getValue(opt.offset, 0, this);\n        var rangeBand = _.nw.getValue(opt.barWidth, this.rangeBand, this);\n        var stack = _.nw.stackLayout();\n        var update = options.bar.stacked ? stacked : grouped;\n        var enter = _.partialRight(update, true);\n        var classFn = function (d, i) { return 'series s-' + (i+1) + ' ' + d.name; };\n\n        data = options.bar.preprocess(data);\n        var series = layer.selectAll('g.series')\n            .data(stack(data));\n\n        series.enter().append('svg:g')\n            .attr('class', classFn);\n\n        series.exit().remove();\n\n        var bars = series.selectAll('.bar')\n            .data(function (d) { return d.data; });\n\n        var cssClass = 'bar' + (options.tooltip.enable ? ' tooltip-tracker' : '');\n        bars.enter().append('rect')\n            .attr('class', function (d, i, j) {\n                if (!rectClass) return cssClass;\n\n                return cssClass + ' ' + (typeof rectClass === 'function' ? rectClass.call(this, d, i, j) : rectClass);\n            })\n            .call(enter);\n\n        if(options.chart.animations && options.chart.animations.enable) {\n            bars\n                .attr('style', style)\n                .transition().duration(duration).call(update);\n            bars.exit()\n                .transition().duration(duration)\n                .attr('width', y(0))\n                .remove();\n        } else {\n            bars.attr('style', style).call(update);\n            bars.exit().remove();\n        }\n\n        function stacked(bar, enter) {\n            bar\n                .attr('y', function (d) { return x(d.x) + chartOffset; })\n                .attr('height', rangeBand);\n\n            if (enter) {\n                return bar\n                    .attr('x', function (d) { return y(0); })\n                    .attr('width', function (d) { return 0; });\n\n            } else {\n                return bar\n                    .attr('x', function (d) { return d.y >= 0 ? y(d.y0 || 0) : y(d.y + d.y0); })\n                    .attr('width', function (d) { return d.y >=0 ? y(d.y) - y(0) : y(0) - y(d.y); });\n            }\n        }\n\n        function grouped(bar, enter) {\n            var numSeries = data.length;\n            var height = function () { return rangeBand / numSeries - options.bar.groupPadding + 0.5; };\n            var offset = function (d, i) { return rangeBand / numSeries * i + 0.5; };\n\n            bar.attr('y', function (d, i, j) { return x(d.x) + offset(d, j) + chartOffset; })\n                .attr('x', y(0))\n                .attr('height', height);\n\n            if (enter) {\n                return bar\n                    .attr('width', function (d) { return 0.5; });\n            } else {\n                return bar\n                    .attr('width', function (d) { return d.y >= 0 ? y(d.y) - y(0) : y(0) - y(d.y); })\n                    .attr('x', function (d) { return d.y < 0 ? y(d.y) : y(0); });\n            }\n        }\n    }\n\n    barRender.defaults = defaults;\n    /**\n    * Adds a bar chart (horizontal columns) to the Contour instance.\n    *\n    * You can use this visualization to render both stacked and grouped charts (controlled through the _options_).\n    *\n    * This visualization requires `.cartesian()` and `.horizontal()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *       .cartesian()\n    *       .horizontal()\n    *       .bar([1,2,3,4])\n    *       .render();\n    *\n    * @name bar(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('bar', barRender);\n\n})();\n","(function () {\n\n    var defaults = {\n        column : {\n            // specifies a class string or function that will be added to each column\n            columnClass: null,\n            style: null,\n            stacked: false,\n            groupPadding: 1,\n            columnWidth: function() { return this.rangeBand; },\n            offset: function() { return 0; }\n        }\n    };\n\n    function render(data, layer, options) {\n        this.checkDependencies('cartesian');\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var opt = options.column;\n        var h = options.chart.plotHeight;\n        var rectClass = options.column.columnClass;\n        var rectStyle = options.column.style;\n        var _this = this;\n        var x = function (v) { return Math.round(_this.xScale(v)) + 0.5; };\n        var y = function (v) { return Math.round(_this.yScale(v)) - 0.5; };\n        var dataKey = function (d) { return d.data; };\n        var chartOffset = _.nw.getValue(opt.offset, 0, this);\n        var rangeBand = _.nw.getValue(opt.columnWidth, this.rangeBand, this);\n        var enter = _.partialRight((options.column.stacked ? stacked : grouped), true);\n        var update = options.column.stacked ? stacked : grouped;\n        var filteredData = _.map(data, function (series, j) {\n            return {\n                name: series.name,\n                data: _.filter(series.data, function (d, i) {\n                    return i === 0 ? true : x(d.x) !== x(series.data[i-1].x);\n                })\n            };\n        });\n\n        var stack = _.nw.stackLayout();\n        var series = layer.selectAll('g.series')\n                .data(stack(filteredData));\n\n        series.enter()\n            .append('g')\n            .attr('class', function (d, i) { return 'series s-' + (i+1) + ' ' + d.name; });\n\n        series.exit()\n            .remove();\n\n        var cols = series.selectAll('.column')\n                .data(dataKey, function (d) { return d.x || d; });\n\n        var cssClass = 'column' + (options.tooltip.enable ? ' tooltip-tracker' : '');\n\n        cols.enter()\n            .append('rect')\n            .attr('class', function (d, i, j) {\n                if (!rectClass) return cssClass;\n\n                return cssClass + ' ' + (typeof rectClass === 'function' ? rectClass.call(this, d, i, j) : rectClass);\n            })\n            .call(enter);\n\n        if (options.chart.animations && options.chart.animations.enable) {\n            cols.exit()\n                .transition().duration(duration)\n                .attr('y', h)\n                .attr('height', function () { return 0.5; })\n                .remove();\n            cols.transition().duration(duration)\n                .call(update);\n        } else {\n            cols.exit().remove();\n            cols.call(update);\n        }\n\n        // for every update\n        cols.attr('style', rectStyle);\n\n        function stacked(col, enter) {\n            var base = y(0);\n\n            col.attr('x', function (d) { return x(d.x) + chartOffset; })\n                .attr('width', function () { return rangeBand; });\n\n            if (enter) {\n                col.attr('y', function (d) { return d.y >= 0 ? base : base; })\n                    .attr('height', function (d) { return 0.5; });\n            } else {\n                col.attr('y', function (d) { return d.y >= 0 ? y(d.y) + y(d.y0) - base : y(d.y0) ; })\n                    .attr('height', function (d) { return d.y >=0 ? base - y(d.y) : y(d.y) - base; });\n            }\n        }\n\n        function grouped(col, enter) {\n            var width = rangeBand / data.length - opt.groupPadding + 0.5;\n            var offset = function (d, i) { return rangeBand / data.length * i + 0.5; };\n            var base = y(0);\n\n            col.attr('x', function (d, i, j) { return x(d.x) + offset(d, j) + chartOffset; })\n                .attr('width', width);\n\n            if (enter) {\n                col.attr('y', base)\n                    .attr('height', 0);\n            } else {\n                col.attr('y', function (d) { return d.y >= 0 ? y(d.y) : base; })\n                    .attr('height', function (d) { return d.y >= 0 ? base - y(d.y) : y(d.y) - base; });\n            }\n        }\n    }\n\n    render.defaults = defaults;\n\n    /**\n    * Adds a column chart (vertical columns) to the Contour instance.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .column([1,2,3,4])\n    *           .render();\n    *\n    * @name column(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('column', render);\n\n})();\n","(function () {\n\n    Contour.export('coolNarwhal', function (data, layer) {\n        layer.append('path')\n            .attr('class', 'cool')\n            .attr('opacity', 0)\n            .attr('transform', 'scale(.5) translate(500 150)')\n            .attr('d', 'M-220.02,76.509l-0.78,8.927c-0.956,10.949,1.389,20.422,6.188,30.383c10.203,21.173,63.095,84.05,93.72,115.075c20.145,20.406,19.487,23.018,21.549,40.122c2.487,20.621,24.897,66.462,40.838,71.269 c15.086,4.549,12.91-12.398,13.319-37.83c5.746,2.457,10.917,5.638,20.206,12.697c61.697,46.892,139.734,69.97,206.5,71.733c46.209,1.221,81.432-7.081,142.957-33.694c40.484-17.512,54.271-22.098,65.639-21.504c4.432,0.232,22.678,11.204,41.746,21.563c35.398,19.229,69.457,34.595,75.896,34.239c12.609-1.457-0.701-11.783-8.072-24.217c-7.049-11.892-15.414-29.572-18.844-42.134s-4.723-22.272-8.91-27.091c-2.143-2.463-12.812-6.786-21.189-8.146c-18.045-2.933-22.191-2.922-13.531-8.957c13.076-9.115,17.377-11.039,1.826-29.068c-6.383-7.402-11.336-20.003-13.709-39.542c-1.607-13.237,1.057-23.679-3.869-27.451s-17.271,12.341-20.846,19.334c-2.01,3.937-7.102,19.005-11.312,33.485c-13.795,47.427-29.865,65.742-62.693,71.447c-34.361,5.971-71.623-9.506-116.543-48.404c-13.164-11.399-29.533-25.26-39.254-36.913c-13.428-16.101-15.48-18.138-19.785-20.66c-16.166-9.472-54.98-31.694-103.525-63.815c-24.393-16.141-57.72-36.928-71.453-43.693c-27.236-13.417-68.416-28.952-90.731-46.771c-24.665-19.697-38.108-19.793-67.804-5.479c-21.429,10.328-23.941,15.298-26.52,15.726c-8.216-10.129-22.917-11.198-31.647-20.682c-9.529-10.35-28.027-14.098-37.824-24.957c-10.668-11.826-31.25-16.752-40.886-26.94c-11.339-11.989-29.387-16.096-40.838-26.637c-11.617-10.694-27.159-14.843-37.68-24.045c-10.383-9.082-23.187-12.538-31.408-19.163c-8.193-6.601-16.593-9.444-22.026-11.993c-5.433-2.549-7.398-2.522-7.658-1.927c-0.26,0.594,1.355,2.955,6.054,6.447c4.699,3.491,22.193,18.451,31.645,22.77c10.921,5.104,17.502,15.01,29.671,21.375c13.224,6.918,22.212,18.731,36.229,25.924c15.53,7.971,24.754,21.184,39.657,28.253c16.462,7.808,25.503,21.598,39.958,28.36c14.499,6.78,20.647,20.252,34.429,23.428C-238.033,58.207-227.932,70.443-220.02,76.509L-220.02,76.509z')\n            .transition()\n                .delay(300)\n                .duration(2000)\n                .attr('opacity', 1);\n    });\n\n})();\n","(function () {\n\n    var defaults = {\n        legend: {\n            vAlign: 'middle',\n            hAlign: 'right',\n            direction: 'vertical',\n            formatter: function (d) {\n                return d.name;\n            },\n            el: undefined\n        }\n    };\n\n    function validAlignmentClasses(options) {\n        var classes = [];\n        if (['top', 'middle', 'bottom'].indexOf(options.legend.vAlign) !== -1) {\n            classes.push(options.legend.vAlign);\n        } else {\n            classes.push('top');\n        }\n\n        if (['left', 'center', 'right'].indexOf(options.legend.hAlign) !== -1) {\n            classes.push(options.legend.hAlign);\n        } else {\n            classes.push('right');\n        }\n\n        if (options.legend.direction === 'vertical') {\n            classes.push('vertical');\n        }\n\n        return classes;\n    }\n\n    function Legend(data, layer, options) {\n        var container;\n        if (options.legend.el) {\n            container = d3.select(options.legend.el).node();\n            while (container.firstChild) {\n                container.removeChild(container.firstChild);\n            }\n        } else {\n            this.container.selectAll('.contour-legend').remove();\n        }\n        var em = _.nw.textBounds('series', '.contour-legend.contour-legend-entry');\n        var count = data.length;\n        var legendHeight = (em.height + 4) * count + 12; // legend has 1px border and 5px margin (12px) and each entry has ~2px margin\n        var mid = (options.chart.plotHeight - legendHeight) / 2;\n        var positioner = function (selection) {\n            // adjust position of legend only when is horizontally centered\n            // since we need to have all elements in the legend to calculate its width\n            if (options.legend.hAlign !== 'center' || !selection.length) {\n                return ;\n            }\n\n            // adjust the left\n            var legendWidth = selection[0].parentNode.clientWidth;\n            var left = (options.chart.plotWidth - legendWidth) / 2 + options.chart.internalPadding.left;\n\n            d3.select(selection[0].parentNode)\n                .style('left', left + 'px');\n        };\n\n        if (options.legend.el) {\n            container = d3.select(options.legend.el);\n        } else {\n            var legend = this.container.selectAll('.contour-legend').data([null]);\n            container = legend.enter().append('div');\n        }\n\n        container.attr('class', function () {\n            return ['contour-legend'].concat(validAlignmentClasses(options)).join(' ');\n        });\n\n        container.attr('style', function () {\n            var styles = [];\n\n            if (options.legend.vAlign === 'top') {\n                styles.push('top: 0');\n            } else if (options.legend.vAlign === 'middle') {\n                styles.push('top: ' + mid + 'px');\n            } else {\n                styles.push('bottom: ' + (options.chart.internalPadding.bottom + 5) + 'px');\n            }\n\n            if (options.legend.hAlign === 'left') {\n                styles.push('left: ' + options.chart.plotLeft + 'px');\n            } else if (options.legend.hAlign === 'center') {\n                var bounds = _.nw.textBounds(this, '.contour-legend');\n\n                styles.push('left: ' + ((options.chart.plotWidth - bounds.width) / 2 + options.chart.internalPadding.left) + 'px' );\n            } else {\n                styles.push('right: 10px');\n            }\n\n            return styles.join(';');\n        });\n\n        var entries = container.selectAll('.contour-legend-entry')\n            .data(data);\n\n        entries.enter()\n            .append('div')\n            .attr('class', function () {\n                return 'contour-legend-entry';\n            });\n\n        entries.append('span')\n            .attr('class', function (d, i) { return 'contour-legend-key series s-' + (i+1) + ' ' + _.nw.seriesNameToClass(d.name); });\n\n        entries.append('span')\n            .attr('class', 'series-name')\n            .text(options.legend.formatter)\n            .call(positioner);\n\n        entries.exit()\n            .remove();\n    }\n\n    Legend.defaults = defaults;\n\n    /**\n    * Adds a legend to the Contour instance. One entry is added to the legend for each series in the data.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .column(data)\n    *           .legend(data)\n    *           .render();\n    *\n    * @name legend(data, options)\n    * @param {object|array} data The _data series_ for which to create a legend. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n\n    Contour.export('legend', Legend);\n\n})();\n","(function () {\n\n    var defaults = {\n        xAxis: {\n            type: 'linear'\n        },\n        line: {\n            stacked: false,\n            smooth: false,\n            animationDirection: 'left-to-right',\n            // animationDirection: 'bottom-to-top',\n            marker: {\n                enable: true,\n                size: 3,\n                animationDelay: 0,\n            },\n            preprocess: _.nw.minMaxFilter(1000)\n        }\n    };\n\n    var duration;\n    var animationDirection;\n    var animationsMap = {\n        'left-to-right': {\n            enter: function (line) {\n                var path = this;\n                path.each(function () {\n                    var totalLength = this.getTotalLength();\n                    d3.select(this)\n                        .attr('stroke-dasharray', totalLength + ' ' + totalLength)\n                        .attr('stroke-dashoffset', totalLength)\n                        .transition().duration(duration).ease('linear')\n                            .attr('stroke-dashoffset', 0)\n                            .transition().duration(0)\n                                .attr('stroke-dasharray', undefined);\n                });\n            },\n\n            update: function (line) {\n                this.attr('d', function (d) { return line(d.data); });\n                this.each(function () {\n                    var totalLength = this.getTotalLength();\n                    d3.select(this)\n                        .attr('stroke-dasharray', totalLength + ' ' + totalLength)\n                        .attr('stroke-dashoffset', totalLength)\n                        .transition().duration(duration).ease('linear')\n                            .attr('stroke-dashoffset', 0)\n                            .transition().duration(0)\n                                .attr('stroke-dasharray', undefined);\n                });\n            }\n        },\n\n        'bottom-to-top': {\n            enter: function (line) {\n                this.transition().duration(duration)\n                    .attr('d', function (d) { return line(d.data); });\n            },\n\n            update: function (line) {\n                this.transition().duration(duration)\n                    .attr('d', function (d) { return line(d.data); });\n            }\n        }\n    };\n\n\n    /* jshint eqnull: true */\n    function render(rawData, layer, options, id) {\n        this.checkDependencies('cartesian');\n\n        var x = _.bind(function (d) { return this.xScale(d.x) + this.rangeBand / 2 + 0.5; }, this);\n        var y = _.bind(function (d) { return this.yScale(d.y + (d.y0 || 0)) + 0.5; }, this);\n        var shouldAnimate = options.chart.animations && options.chart.animations.enable;\n        animationDirection = options.line.animationDirection || 'left-to-right';\n        duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        // jshint eqnull:true\n        var data = options.line.preprocess(_.nw.cleanNullValues()(rawData));\n\n        data = options.line.stacked ? d3.layout.stack().values(function (d) { return d.data; })(data) : data;\n\n        renderPaths();\n\n        if (options.line.marker.enable)\n            renderMarkers();\n\n        if (options.tooltip && options.tooltip.enable)\n            renderTooltipTrackers();\n\n        function seriesClassName(extras) { return function (d, i) { return (extras||'') + ' s-' +(i+1) + ' ' + _.nw.seriesNameToClass(d.name); }; }\n\n        function renderPaths() {\n            var startLine = d3.svg.line()\n                .x(function (d) { return x(d); })\n                .y(function () { return y({x: 0, y: options.yAxis.min || 0}); });\n\n            var line = d3.svg.line()\n                .x(function (d) { return x(d); })\n                .y(function (d) { return y(d); });\n\n            if(options.line.smooth) line.interpolate('cardinal');\n\n            var animFn = animationsMap[animationDirection];\n            var series = layer.selectAll('g.series')\n                    .data(data, function (d) { return d.name; });\n\n            // enter\n            var el = series.enter().append('svg:g')\n                .attr('class',seriesClassName('series'))\n                .append('path')\n                    .attr('class', 'line');\n\n            if (shouldAnimate) {\n                var startLineFn = animationDirection === 'left-to-right' ? line : startLine;\n                el.attr('d', function(d) { return startLineFn(d.data); })\n                    .call(_.partial(animFn.enter, line));\n            } else {\n                el.attr('d', function (d) { return line(d.data); });\n            }\n\n            // update\n            el = series\n                .attr('class', seriesClassName('series'))\n                .select('.line');\n\n            if (shouldAnimate) {\n                el.call(_.partial(animFn.update, line));\n            } else  {\n                el.attr('d', function (d) { return line(d.data); });\n            }\n\n            // remove\n            if (shouldAnimate) {\n                series.exit()\n                    .remove();\n            } else  {\n                series.exit().remove();\n            }\n        }\n\n        function renderMarkers() {\n            var animationDelay = options.line.marker.animationDelay;\n            var markers = layer.selectAll('.line-chart-markers')\n                .data(data, function (d) { return d.name; });\n\n            markers.enter().append('g')\n                .attr('class', seriesClassName('line-chart-markers markers'));\n\n            markers.exit().remove();\n\n            var dots = markers.selectAll('.dot')\n                .data(function (d) { return d.data; }, function (d) { return d.x; });\n\n            if (shouldAnimate) {\n                dots.transition().delay(animationDelay).duration(duration)\n                    .attr('cx', x)\n                    .attr('cy', y)\n                    .attr('opacity', 1);\n            } else {\n                dots.attr('cx', x)\n                    .attr('cy', y)\n                    .attr('opacity', 1);\n            }\n\n\n            dots.enter().append('circle')\n                .attr('class', 'dot')\n                .attr('r', options.line.marker.size)\n                .attr('opacity', 0)\n                .attr('cx', x)\n                .attr('cy', y)\n                .transition().delay(duration)\n                    .attr('opacity', 1);\n\n            dots.exit().remove();\n\n        }\n\n        function renderTooltipTrackers() {\n            var trackerSize = 10;\n            var markers = layer.selectAll('.tooltip-trackers')\n                .data(data, function (d) { return d.name; });\n\n            markers.enter().append('g')\n                .attr('class', seriesClassName('tooltip-trackers'));\n\n            markers.exit().remove();\n\n            var dots = markers.selectAll('.tooltip-tracker')\n                .data(function (d) { return d.data; }, function (d) { return d.x; });\n\n            dots.enter().append('circle')\n                .attr({\n                    'class': 'tooltip-tracker',\n                    'r': trackerSize,\n                    'opacity': 0\n                });\n\n            dots.attr({\n                'cx': x,\n                'cy': y\n            });\n\n            dots.exit().remove();\n        }\n\n        return this;\n    }\n\n    render.defaults = defaults;\n\n\n    /**\n    * Adds a line chart to the Contour instance.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .line([1,2,3,4])\n    *           .render();\n    *\n    * @name line(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('line', render);\n\n})();\n","Contour.export('nullVis', _.noop);\n","(function () {\n\n    var defaults = {\n        pie: {\n            sliceClass: null,\n\n            style: null,\n\n            piePadding: {\n                left: null,\n                top: null,\n                right: null,\n                bottom: null\n            },\n\n            // inner and outer radius can be numbers of pixels if >= 1, percentage if > 0 && < 1 or functions\n\n            // inner radius as function will recive the outerRadius as parameter\n            // passing a value between 0 and 1 (non-inclusing), this value is interpreted as % of radius\n            // ie. outerRadius: 100, innerRadius: .8 would give a inner radius or 80 pixles\n            innerRadius: null,\n\n            // outer radius as function will recieve the proposed maximum radius for a pie\n            // passing a value between 0 and 1 (non-inclusing), this value is interpreted as % of width\n            // the default behavior is 50% of the mininum between with and height of the container (adjusted for padding)\n            outerRadius: null\n        }\n    };\n\n    function normalizePadding(options) {\n        if (_.isNumber(options.pie.piePadding)) {\n            return {\n                top: options.pie.piePadding,\n                left: options.pie.piePadding,\n                right: options.pie.piePadding,\n                bottom: options.pie.piePadding\n            };\n        }\n\n        return options.pie.piePadding;\n    }\n\n    function clampBounds(bounds, maxWidth, maxHeight) {\n        return {\n            top: _.nw.clamp(bounds.top, 0, maxHeight),\n            bottom: _.nw.clamp(bounds.bottom, 0, maxHeight),\n            left: _.nw.clamp(bounds.left, 0, maxWidth),\n            right: _.nw.clamp(bounds.right, 0, maxWidth)\n        };\n    }\n\n    function calcPadding(options) {\n        var padding = normalizePadding(options);\n        var w = options.chart.plotWidth;\n        var h = options.chart.plotHeight;\n\n        return clampBounds(padding, w, h);\n    }\n\n    function resolveValueUnits(value, ref) {\n        // resolve (0,1) interval to a percentage of the reference value\n        // otherwise as a pixel valie\n        return value > 0 && value < 1 ? ref * value : value;\n    }\n\n    function resolvePaddingUnits(padding, w, h) {\n        // if the value of padding is betweem 0 and 1 (non inclusing),\n        // interpret it as a percentage, otherwise as a pixel value\n        return {\n            top: resolveValueUnits(padding.top, h) || 5,\n            bottom: resolveValueUnits(padding.bottom, h) || 5,\n            left: resolveValueUnits(padding.left, w) || 5,\n            right: resolveValueUnits(padding.right, w) || 5\n        };\n    }\n\n    function renderer(data, layer, options) {\n        /*jshint eqnull:true */\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var shouldAnimate = options.chart.animations && options.chart.animations.enable;\n        var w = options.chart.plotWidth, h = options.chart.plotHeight;\n        var padding = calcPadding.call(this, options);\n        var numSeries = data.length;\n        var style = options.pie.style;\n        var _this = this;\n        var shouldCenterX = _.all([options.pie.piePadding.left, options.pie.piePadding.right], function (d) { return d == null; });\n        var shouldCenterY = _.all([options.pie.piePadding.top, options.pie.piePadding.bottom], function (d) { return d == null; });\n        var pixelPadding = resolvePaddingUnits(padding, w, h);\n        // the reference size is the min between with and height of the container\n        var referenceSize = Math.min(w, h);\n\n        // for auto radius we need to take the min between the available with or height adjusted by padding and num series\n        var totalPadding = pixelPadding.left + (pixelPadding.right + pixelPadding.left) * (numSeries - 1) + pixelPadding.right;\n        var proposedRadius = Math.min(((w - totalPadding) / numSeries) / 2, (h - pixelPadding.top - pixelPadding.bottom) / 2);\n        var radius = resolveValueUnits(_.nw.getValue(options.pie.outerRadius, proposedRadius, this, proposedRadius, referenceSize), referenceSize);\n        // inner radius is a pixel value or % of the radius\n        var innerRadius = resolveValueUnits(_.nw.getValue(options.pie.innerRadius, 0, this, radius), radius);\n        var pieData = d3.layout.pie().value(function (d) { return d.y; }).sort(null);\n        var totalWidth = totalPadding + radius * numSeries * 2;\n        var outerPaddingLeft = shouldCenterX ? (w - totalWidth) / 2 : pixelPadding.left;\n        var centerY = h / 2;\n\n        var classFn = function (d, i, j) {\n            var baseClass = 'series arc' + (options.tooltip.enable ? ' tooltip-tracker' : '') + ' s-' + (i+1) + ' ' + d.data.x;\n\n            if (!options.pie.sliceClass) {\n                return baseClass;\n            }\n\n            return baseClass + ' ' + (typeof options.pie.sliceClass === 'function' ? options.pie.sliceClass.call(_this, d, i, j) : options.pie.sliceClass);\n        };\n\n        var translatePie = function (d,i) {\n            // calc the left side coord of the pie, including padding for the prevousous pies\n            var offsetX = outerPaddingLeft + (radius * 2 * i + (pixelPadding.right + pixelPadding.left) * i);\n            // calc the center of the pie starting from offsetX\n            var posY = shouldCenterY ? centerY : radius + pixelPadding.top;\n\n            return 'translate(' + (radius + offsetX) + ',' + (posY) + ')';\n        };\n\n        var pieGroup = layer.selectAll('g.pie-group')\n            .data(data);\n\n        pieGroup.enter().append('svg:g')\n            .attr('class', 'pie-group')\n            .attr('transform', translatePie)\n            .call(renderSeries);\n\n        pieGroup.exit().remove();\n\n        if (shouldAnimate) {\n            pieGroup\n                .call(renderSeries)\n                .transition().duration(duration/2)\n                .attr('transform', translatePie);\n        } else {\n            pieGroup.call(renderSeries)\n                .attr('transform', translatePie);\n        }\n\n        function renderSeries(group) {\n            var arc = d3.svg.arc()\n                .outerRadius(radius).innerRadius(innerRadius);\n\n            var startArc = d3.svg.arc()\n                .outerRadius(radius).innerRadius(innerRadius)\n                .startAngle(0).endAngle(0);\n\n            var pie = group.selectAll('path')\n                .data(function (d) { return pieData(d.data); }, function (d) { return d.data.x; });\n\n            pie.enter()\n                .append('path')\n                .attr('class', classFn)\n                .attr('d', function (d) { return startArc(d); })\n                .attr('style', style)\n                .each(function (d) { this._current = { startAngle: d.startAngle, endAngle: d.startAngle }; });\n\n\n            if (shouldAnimate) {\n                pie.exit()\n                    .remove();\n\n                pie.transition().duration(duration)\n                    .ease('cubic-in')\n                    .attrTween('d', arcTween);\n            } else {\n                pie.exit().remove();\n                pie.attr('d', arc);\n            }\n\n            // Store the displayed angles in _current.\n            // Then, interpolate from _current to the new angles.\n            // During the transition, _current is updated in-place by d3.interpolate.\n            // from http://bl.ocks.org/mbostock/1346410\n            function arcTween(a) {\n                var i = d3.interpolate(this._current, a);\n                this._current = i(0);\n                return function(t) {\n                    return arc(i(t));\n                };\n            }\n        }\n    }\n\n    renderer.defaults = defaults;\n\n\n    /**\n    * Adds a pie chart to the Contour instance.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .pie([1,2,3,4])\n    *           .render();\n    *\n    * @name pie(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats. The data elements are summed and then divided. In the example, `.pie([1,2,3,4])` makes four pie slices: 1/10, 2/10, 3/10, and 4/10.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('pie', renderer);\n\n})();\n","(function () {\n\n    var defaults = {\n        xAxis: {\n            type: 'linear'\n        },\n        scatter: {\n            radius: 4,\n            preprocess: function(data) {\n                return data;\n            }\n        }\n    };\n\n    function ScatterPlot(data, layer, options) {\n        this.checkDependencies('cartesian');\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var shouldAnimate = options.chart.animations && options.chart.animations.enable;\n        var opt = options.scatter;\n        var halfRangeBand = this.rangeBand / 2;\n        var x = _.bind(function (d) { return this.xScale(d.x) + halfRangeBand; }, this);\n        var y = _.bind(function (d) { return this.yScale(d.y); }, this);\n        var h = options.chart.plotHeight;\n        var classFn = function (d, i) { return d.name + ' series s-' + (i+1); };\n\n        data = options.scatter.preprocess(data);\n        \n        var series = layer.selectAll('.series')\n            .data(data);\n\n        series.attr('class', classFn);\n\n        series.enter().append('svg:g')\n            .attr('class', classFn);\n\n        series.exit().remove();\n\n        var dots = series.selectAll('.dot')\n            .data(function (d) { return d.data; }, function (d) {\n                return options.scatter.dataKey ? d[options.scatter.dataKey] : d.x;\n            });\n\n        dots.enter().append('circle')\n                .attr('class', 'dot tooltip-tracker')\n                .attr('r', opt.radius)\n                .attr('cx', x)\n                .attr('cy', h);\n\n        if (shouldAnimate) {\n            dots.transition().duration(duration)\n                .attr('r', opt.radius)\n                .attr('cx', x)\n                .attr('cy', y);\n        } else {\n            dots.attr('r', opt.radius)\n                .attr('cx', x)\n                .attr('cy', y);\n        }\n\n\n        dots.exit().remove();\n    }\n\n    ScatterPlot.defaults = defaults;\n\n    /**\n    * Adds a scatter plot to the Contour instance.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.chart'})\n    *           .cartesian()\n    *           .scatter([1,2,3,4])\n    *           .render();\n    *\n    * @name scatter(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('scatter', ScatterPlot);\n\n\n})();\n","(function () {\n    var defaults = {\n        tooltip: {\n            enable: true\n        }\n    };\n\n    /**\n    * Adds a tooltip and legend combination for stacked (multiple) series visualizations in the Contour instance.\n    * Requires a second display element (`<div>`) for the legend in the html.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .column(stackedColData)\n    *           .stackTooltip(stackedColData, {el: '.myChartLegend'})\n    *           .render();\n    *\n    * @name stackTooltip(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats.\n    * @param {object} options Configuration options particular to this visualization that override the defaults. Requires an `el` option with the selector of the container in which to render the tooltip.\n    * @api public\n    *\n    * ### Notes:\n    *\n    * Each Contour instance can only include one `stackTooltip` visualization.\n    */\n    function stackTooltip(data, layer, options) {\n\n        var valueFormatter = this.yAxis().tickFormat();\n        var tooltip = d3.select(options.stackTooltip.el);\n\n        tooltip.classed('stack-tooltip', true);\n\n        // jshint eqnull:true\n        var onMouseOver = function (d) {\n            var isNull = function (p) {\n                return !(p && p.y != null);\n            };\n            var mapFn = function (p, i) {\n                var index = _.isNumber(d.x) ? d.x : options.xAxis.categories.indexOf(d.x);\n                return !isNull(p.data[index]) ?\n                    { seriesName: p.name, value: p.data[index].y, cssClass: 's-' + (i+1) } :\n                    null;\n            };\n            var filtered = _.filter(_.map(data, mapFn), function (x) { return x; });\n            var text = _.map(filtered, function (t) { return '<span class=\"' + t.cssClass + '\"\">' + t.seriesName + ': ' + valueFormatter(t.value) + '</span>'; }).join(' / ');\n            tooltip.html(text).style({display: 'block'});\n        };\n\n        var onMouseOut = function (// datum\n                                    ) {\n            tooltip.html('');\n        };\n\n        this.svg.selectAll('.tooltip-tracker')\n            .on('mouseover.tooltip', onMouseOver.bind(this))\n            .on('mouseout.tooltip',  onMouseOut.bind(this));\n    }\n\n    stackTooltip.defaults = defaults;\n\n    Contour.export('stackTooltip', stackTooltip);\n\n})();\n","(function () {\n    var defaults = {\n        tooltip: {\n            enable: true,\n            animate: true,\n            opacity: 0.85,\n            showTime: 300,\n            hideTime: 500,\n            distance: 5,\n            formatter: undefined //defined in formatters array in getTooltipText()\n        }\n    };\n\n    function render(data, layer, options) {\n\n        var clearHideTimer = function () {\n            clearTimeout(this.tooltip.hideTimer);\n        };\n\n        var changeOpacity = function (opacity, delay) {\n            if(this.options.tooltip.animate) {\n                this.tooltipElement\n                    .transition().duration(delay)\n                        .style('opacity', opacity);\n            } else {\n                this.tooltipElement.style('opacity', opacity);\n            }\n        };\n\n        var positionTooltip = function (d) {\n            var pointOrCentroid = function () {\n                return d3.event.target.tagName === 'path' ? _.nw.getCentroid(d3.event.target) : d3.mouse(this.container.node());\n            };\n            var xScale = this.xScale;\n            var yScale = this.yScale;\n            var plotLeft = this.options.chart.plotLeft;\n            var plotWidth = this.options.chart.plotWidth;\n            var plotTop = this.options.chart.plotTop;\n            var plotHeight = this.options.chart.plotHeight;\n            var distance = this.options.tooltip.distance;\n            var width = parseFloat(this.tooltipElement.node().offsetWidth);\n            var height = parseFloat(this.tooltipElement.node().offsetHeight);\n            var pointX = xScale ? xScale(d.x) : pointOrCentroid.call(this)[0];\n            var pointY = yScale ? yScale(d.y) : pointOrCentroid.call(this)[1];\n            var alignedRight;\n\n            var clampPosition = function (pos) {\n                // Check outside plot area (left)\n                if (pos.x < plotLeft) {\n                    pos.x = plotLeft + distance;\n                }\n\n                // Check outside plot area (right)\n                if (pos.x + width > plotLeft + plotWidth) {\n                    pos.x -= (pos.x + width) - (plotLeft + plotWidth);\n                    // Don't overlap point\n                    pos.y = plotTop + pointY - (height + distance);\n                    alignedRight = true;\n                }\n\n                // Check outside the plot area (top)\n                if (pos.y < plotTop) {\n                    pos.y = plotTop + distance;\n\n                    // Don't overlap point\n                    if (alignedRight && pointY >= pos.y && pointY <= pos.y + height) {\n                        pos.y = pointY + plotTop + distance;\n                    }\n                }\n\n                // Check outside the plot area (bottom)\n                if (pos.y + height > plotTop + plotHeight) {\n                    pos.y = Math.max(plotTop, plotTop + plotHeight - (height + distance));\n                }\n\n                return pos;\n            };\n\n            var positioner = {\n                'vertical': function verticalPositioner() {\n                    var pos = {\n                        x: plotLeft + pointX - (distance + width),\n                        y: plotTop + pointY - (distance + height)\n                    };\n\n                    return clampPosition(pos);\n                },\n\n                'horizontal': function horizontalPositioner() {\n                    var pos = {\n                        x: plotLeft + pointY - (distance + width),\n                        y: plotTop + pointX - (distance + height)\n                    };\n\n                    return clampPosition(pos);\n                }\n            };\n\n            return options.chart.rotatedFrame ? positioner.horizontal() : positioner.vertical();\n\n        };\n\n        var onMouseOver = function (d) {\n            show.call(this, d);\n        };\n\n        var onMouseOut = function () {\n            changeOpacity.call(this, 0, this.options.tooltip.hideTime);\n        };\n\n        var getTooltipText = function (d, allPoints) {\n            function match() {\n                var params = Array.prototype.slice.call(arguments);\n                var list = params[0];\n                var rest = params.slice(1);\n\n                var response = _.map(list, function(fn) { return fn.apply(this, rest); }).concat([_.noop]);\n\n                return _.first(_.select(response));\n            }\n\n            var options = this.options.tooltip;\n            var formatters = [\n                function (d) { return options.formatter ? _.partial(options.formatter, d, allPoints) : null; },\n                function (d) { return d.hasOwnProperty('x') ? _.partial(function (d) { return d.series + '<br>' + d.x + '<br>' + d.y; }, d) : null; },\n                function (d) { return d.data && d.data.hasOwnProperty('x') ? _.partial(function (d) { return d.series + '<br>' +  d.x + '<br>' + d.y; }, d.data) : null; },\n                function (d) { return d.hasOwnProperty('value') ? _.partial(function (d) { return d.value; }, d) : null;  },\n                function () { return function () { return 'NA'; }; }\n            ];\n\n\n            return match(formatters, d)();\n        };\n\n        var show = function (d) {\n            clearHideTimer.call(this);\n\n            var dataPoints = findOriginalDataPoint(d);\n\n            this.tooltipElement.select('.text').html(getTooltipText.call(this, dataPoints[0] || d, dataPoints));\n\n            var pos = positionTooltip.call(this, d);\n\n            this.tooltipElement\n                .style('top', pos.y + 'px')\n                .style('left', pos.x + 'px');\n\n            changeOpacity.call(this, this.options.tooltip.opacity, this.options.tooltip.showTime);\n        };\n\n        function findOriginalDataPoint(d) {\n            var res = [];\n            _.each(data, function (series, seriesIndex) {\n                var name = series.name;\n                _.each(series.data, function (point) {\n                    if (point.x === d.x && d.y === point.y) {\n                        res.push(_.extend(point, { series: name, seriesIndex:seriesIndex }));\n                    }\n                });\n            });\n\n            return res;\n        }\n\n        this.tooltipElement = this.container\n            .style('position', 'relative')\n            .selectAll('.nw-tooltip').data([1]);\n\n        this.tooltipElement\n            .enter().append('div')\n            .attr('class', 'nw-tooltip')\n            .style('opacity', 0)\n            .append('div')\n                .attr('class', 'text');\n\n        this.svg.selectAll('.tooltip-tracker')\n            .on('mouseover.tooltip', onMouseOver.bind(this))\n            .on('mouseout.tooltip',  onMouseOut.bind(this));\n    }\n\n    render.defaults = defaults;\n\n\n    /**\n    * Adds a tooltip on hover to all other visualizations in the Contour instance.\n    *\n    * Although not strictly required, this visualization does not appear unless there are already one or more visualizations in this Contour instance for which to show the tooltips.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .line([2, 4, 3, 5, 7])\n    *           .tooltip()\n    *           .render();\n    *\n    * @name tooltip(data, options)\n    * @param {object|array} data Ignored!\n    * @param {object} options Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    * ### Notes:\n    *\n    * Each Contour instance can only include one `tooltip` visualization.\n    */\n    Contour.export('tooltip', render);\n\n\n})();\n\n\n","(function () {\n\n    function normalizeDataSet(dataSet) {\n        var all = _.flatten(_.pluck(dataSet, 'data'));\n        var isLinear = all.length && _.isNumber(all[0].x);\n        var normalizer = function (d, i) { return { x: i, y: d.y }; };\n\n        return isLinear ? all : _.map(all, normalizer);\n    }\n\n    function ctor(raw, layer, options) {\n        this.checkDependencies('cartesian');\n        var data = normalizeDataSet(raw);\n        var duration = options.chart.animations.duration != null ? options.chart.animations.duration : 400;\n        var shouldAnimate = options.chart.animations && options.chart.animations.enable;\n        var x = _.bind(function(d) { return this.xScale(d) + this.rangeBand / 2; }, this);\n        var y = _.bind(function(d) { return this.yScale(d); }, this);\n        var regression = _.nw.linearRegression(data);\n        var domain = d3.extent(this.xScale.domain());\n        var numericDomain = d3.extent(data, function(p) { return p.x; });\n        var lineY = function (x) { return regression.intercept + regression.slope * x; };\n\n        var line = layer.selectAll('.trend-line')\n            .data([1]);\n\n        line.enter().append('line')\n            .attr('class', 'trend-line')\n            .attr('x1', x(domain[0]))\n            .attr('y1', y(lineY(numericDomain[0])))\n            .attr('x2', x(domain[0]))\n            .attr('y2', y(lineY(numericDomain[0])));\n\n        line.exit().remove();\n\n        if (shouldAnimate) {\n            line = line.transition().duration(duration);\n        }\n\n        line.attr('x1', x(domain[0]))\n            .attr('y1', y(lineY(numericDomain[0])))\n            .attr('x2', x(domain[1]))\n            .attr('y2', y(lineY(numericDomain[1])));\n    }\n\n    ctor.defaults = {};\n\n    /**\n    * Adds a trend line to the Contour instance, based on linear regression.\n    *\n    * This visualization requires `.cartesian()`.\n    *\n    * ### Example:\n    *\n    *     new Contour({el: '.myChart'})\n    *           .cartesian()\n    *           .trendLine([2,4,3,5,7])\n    *           .render();\n    *\n    * @name trendLine(data, options)\n    * @param {object|array} data The _data series_ to be rendered with this visualization. This can be in any of the supported formats. A linear regression is performed on the _data series_ and the resulting trend line is displayed.\n    * @param {object} [options] Configuration options particular to this visualization that override the defaults.\n    * @api public\n    *\n    */\n    Contour.export('trendLine', ctor);\n\n})();\n"]}